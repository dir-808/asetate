{% extends "base.html" %}

{% block title %}Settings - Asetate{% endblock %}

{% block content %}
<div class="settings-page">
    <header class="page-header">
        <h1>Settings</h1>
        <p class="text-secondary">Manage your account and Discogs connection</p>
    </header>

    <!-- Account Info -->
    <section class="settings-section card">
        <h2>Account</h2>
        <div class="account-info">
            {% if current_user.picture %}
            <img src="{{ current_user.picture }}" alt="Profile" class="account-avatar">
            {% endif %}
            <div class="account-details">
                <p class="account-name">{{ current_user.name or 'User' }}</p>
                <p class="account-email text-secondary">{{ current_user.email }}</p>
            </div>
        </div>
    </section>

    <!-- Discogs Connection -->
    <section class="settings-section card">
        <h2>Discogs Connection</h2>

        {% if current_user.has_discogs_credentials %}
        <div class="discogs-connected">
            <div class="connection-status">
                <span class="status-indicator status-completed"></span>
                <span>Connected as <strong>{{ current_user.discogs_username }}</strong></span>
            </div>
            <form action="{{ url_for('auth.disconnect_discogs') }}" method="POST" class="disconnect-form">
                <button type="submit" class="btn btn-secondary btn-sm" onclick="return confirm('Disconnect your Discogs account? Your collection data will remain.')">
                    Disconnect
                </button>
            </form>
        </div>
        <p class="text-muted" style="margin-top: var(--space-md);">
            Your Discogs account is connected. You can sync your collection from the
            <a href="{{ url_for('sync.sync_page') }}">Sync page</a>.
        </p>
        {% else %}
        <div class="discogs-not-connected">
            <p class="text-muted" style="margin-bottom: var(--space-md);">
                Connect your Discogs account to sync your vinyl collection. This will allow
                Asetate to read your collection data from Discogs.
            </p>

            <a href="{{ url_for('auth.connect_discogs') }}" class="btn btn-primary btn-discogs">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 8px;">
                    <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm0 2.824a9.176 9.176 0 110 18.352 9.176 9.176 0 010-18.352zm0 1.412a7.765 7.765 0 100 15.528 7.765 7.765 0 000-15.528zm0 2.118a5.647 5.647 0 110 11.292 5.647 5.647 0 010-11.292zm0 1.411a4.235 4.235 0 100 8.47 4.235 4.235 0 000-8.47zm0 2.118a2.117 2.117 0 110 4.234 2.117 2.117 0 010-4.234z"/>
                </svg>
                Connect to Discogs
            </a>

            <p class="text-muted" style="margin-top: var(--space-lg); font-size: 0.85rem;">
                You will be redirected to Discogs to authorize access to your collection.
                Asetate only requests read access to your collection data.
            </p>
        </div>
        {% endif %}
    </section>

    <!-- Danger Zone -->
    <section class="settings-section card">
        <h2>Account Actions</h2>
        <a href="{{ url_for('auth.logout') }}" class="btn btn-secondary">Sign Out</a>
    </section>
</div>
{% endblock %}
