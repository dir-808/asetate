{#
    Centralized Icon System (Noto Emoji Font)
    =========================================
    All icon rendering logic in one place.
    Import this file in any template that needs icons.

    Usage:
        {% from "_icons.html" import emoji_icon, crate_icon %}

        {{ emoji_icon('vinyl', size='xl') }}
        {{ crate_icon(crate, size='2xl') }}
#}

{#
    Emoji character mapping
    Maps friendly icon names to Unicode emoji characters
    Using Noto Emoji font (monochrome, medium weight)
#}
{%- set EMOJI_CHARS = {
    'folder': 'ğŸ“',
    'vinyl': 'ğŸ’¿',
    'headphones': 'ğŸ§',
    'music': 'ğŸµ',
    'speaker': 'ğŸ”Š',
    'disco': 'ğŸª©',
    'wave': 'ğŸŒŠ',
    'fire': 'ğŸ”¥',
    'bolt': 'âš¡',
    'star': 'â­',
    'heart': 'â¤',
    'diamond': 'ğŸ’',
    'crown': 'ğŸ‘‘',
    'sun': 'ğŸŒ',
    'moon': 'ğŸŒ™',
    'globe': 'ğŸŒ',
    'clock': 'ğŸ•°',
    'skull': 'ğŸ’€',
    'box': 'ğŸ“¦',
    'check': 'âœ”',
    'plus': 'â•',
    'link': 'ğŸ”—',
    'edit': 'âœ',
    'sync': 'ğŸ”„',
    'notes': 'ğŸ“',
    'tag': 'ğŸ·'
} -%}

{#
    Render an emoji icon using Noto Emoji font

    Parameters:
        name: Icon name (e.g., 'vinyl', 'folder', 'fire')
        size: Size modifier ('sm', 'base', 'md', 'lg', 'xl', '2xl', '3xl', '4xl')
              Default is 'xl' (24px). Use size class tokens instead of pixels.
        color: Optional color override (hex or CSS color)

    Example:
        {{ emoji_icon('vinyl', size='2xl', color='#F97316') }}
        {{ emoji_icon('folder') }}  {# uses default 'xl' size #}
#}
{% macro emoji_icon(name, size='xl', color=None) -%}
{%- set char = EMOJI_CHARS.get(name, 'ğŸ“') -%}
<span class="emoji-icon emoji-icon--{{ size }}"{% if color %} style="color: {{ color }};"{% endif %}>{{ char }}</span>
{%- endmacro %}


{#
    Render a crate's icon with its color

    Parameters:
        crate: Crate object with .icon and .color_hex attributes
        size: Size modifier ('sm', 'base', 'md', 'lg', 'xl', '2xl', '3xl', '4xl')
              Default is 'xl' (24px). Use size class tokens instead of pixels.

    The crate.icon can be in format:
        - "emoji:HEXCODE" (e.g., "emoji:1F4BF") - new format, hexcode converted to emoji
        - "emoji:iconname" (e.g., "emoji:vinyl") - legacy format, looked up in EMOJI_CHARS
        - "pixel:iconname" - legacy format, looked up in EMOJI_CHARS
    Falls back to 'folder' icon if not set or invalid format.

    Example:
        {{ crate_icon(crate, size='2xl') }}
#}
{% macro crate_icon(crate, size='xl') -%}
{%- set icon_value = crate.icon[6:] if crate.icon and (crate.icon.startswith('emoji:') or crate.icon.startswith('pixel:')) else '' -%}
{%- if icon_value and icon_value[0:1] in '0123456789ABCDEF' -%}
{# Hexcode format - render using HTML entity #}
<span class="emoji-icon emoji-icon--{{ size }}" data-hexcode="{{ icon_value }}"{% if crate.color_hex %} style="color: {{ crate.color_hex }};"{% endif %}>&#x{{ icon_value.split('-')[0] }};</span>
{%- elif icon_value -%}
{# Icon name format - lookup in EMOJI_CHARS #}
{%- set char = EMOJI_CHARS.get(icon_value, 'ğŸ“') -%}
<span class="emoji-icon emoji-icon--{{ size }}"{% if crate.color_hex %} style="color: {{ crate.color_hex }};"{% endif %}>{{ char }}</span>
{%- else -%}
{# No icon set - use default folder #}
<span class="emoji-icon emoji-icon--{{ size }}"{% if crate.color_hex %} style="color: {{ crate.color_hex }};"{% endif %}>ğŸ“</span>
{%- endif -%}
{%- endmacro %}


{#
    Render sync icon (inline SVG for color inheritance)

    Parameters:
        size: Size in pixels (default 18)

    Example:
        {{ sync_icon(size=18) }}
#}
{% macro sync_icon(size=18) -%}
<svg class="sync-icon" width="{{ size }}" height="{{ size }}" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M21 2v6h-6"/>
  <path d="M3 12a9 9 0 0 1 15-6.7L21 8"/>
  <path d="M3 22v-6h6"/>
  <path d="M21 12a9 9 0 0 1-15 6.7L3 16"/>
</svg>
{%- endmacro %}
