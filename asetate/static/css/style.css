/* =============================================
   ASETATE DESIGN SYSTEM
   MPC2000-inspired dark industrial aesthetic
   =============================================

   This file is organized using CUBE CSS methodology:
   1. COMPOSITION - Layout primitives (grids, flex containers)
   2. BLOCKS - Component styles (buttons, cards, panels)
   3. UTILITIES - Single-purpose helpers (spacing, text)
   4. EXCEPTIONS - State variations (.is-loading, .selected)

   ============================================= */

@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap');

/* =============================================
   DESIGN TOKENS
   Single source of truth for all design values
   ============================================= */

:root {
    /* -----------------------------------------
       COLORS - MPC-inspired palette
       ----------------------------------------- */

    /* Backgrounds (dark to light) */
    --bg-body: #0a0a0a;
    --bg-primary: #121212;
    --bg-surface: #1a1a1a;
    --bg-elevated: #222222;
    --bg-input: #0d0d0d;
    --bg-hover: rgba(255, 255, 255, 0.05);

    /* Borders */
    --border: #2a2a2a;
    --border-light: #3a3a3a;

    /* LCD green tint for displays/data */
    --lcd-bg: #0a1210;
    --lcd-text: #4ade80;
    --lcd-muted: #52a872;            /* Secondary LCD text - darker but readable */
    --lcd-dim: #22543d;

    /* Primary accent - MPC Orange */
    --primary: #f97316;
    --primary-hover: #ea580c;
    --primary-dim: #7c2d12;
    /* Primary 3D depth (button edge lighting) */
    --primary-light: #fb923c;       /* Light edge (top) */
    --primary-dark: #c2410c;        /* Dark edge (bottom) */
    --primary-lighter: #fdba74;     /* Lighter edge (hover top) */
    --primary-darker: #9a3412;      /* Darker edge (hover bottom) */

    /* Status colors */
    --success: #4ade80;
    --lime: #84cc16;         /* Energy level 2 (between success and warning) */
    --warning: #fbbf24;
    --error: #ef4444;
    /* Error 3D depth (danger button edges) */
    --error-light: #f87171;         /* Light edge (top) */
    --error-dark: #991b1b;          /* Dark edge (bottom) */
    --error-lighter: #fca5a5;       /* Lighter edge (hover top) */
    --error-darker: #7f1d1d;        /* Darker edge (hover bottom) */

    /* Neutral 3D depth (secondary button edges) */
    --neutral-light: #525252;       /* Light edge (top) */
    --neutral-dark: #262626;        /* Dark edge (bottom) */
    --neutral-lighter: #6b7280;     /* Lighter edge (hover top) */
    --neutral-darker: #1f2937;      /* Darker edge (hover bottom) */

    /* Component-specific colors */
    --tag-default: #E07A5F;  /* Default tag color (terracotta) */
    --color-none: #e0e0e0;   /* "No color" option in color pickers */

    /* Text hierarchy */
    --text-primary: #e5e5e5;
    --text-secondary: #a3a3a3;
    --text-muted: #8a8a8a;        /* WCAG AA compliant (4.5:1 on dark bg) */

    /* Crate box theme (wooden crate) */
    --crate-wood-dark: #1a1815;     /* Darkest wood - inner shadow */
    --crate-wood-mid: #2a2520;      /* Medium wood - base */
    --crate-wood-light: #3d352d;    /* Lighter wood - highlights/borders */

    /* Discogs brand colors (third-party, keep in sync with Discogs branding) */
    --discogs-bg: #333333;          /* Discogs button background */
    --discogs-bg-hover: #444444;    /* Discogs button hover */
    --discogs-border: #444444;      /* Discogs button border */
    --discogs-border-hover: #555555;/* Discogs button border hover */
    --discogs-text: #ffffff;        /* Discogs button text */

    /* -----------------------------------------
       BACKGROUND TINTS
       Semi-transparent color overlays for subtle backgrounds
       ----------------------------------------- */
    /* Primary (orange) tints */
    --primary-bg-faint: rgba(249, 115, 22, 0.03);   /* Very subtle background */
    --primary-bg-subtle: rgba(249, 115, 22, 0.06);  /* Subtle background */
    --primary-bg-muted: rgba(249, 115, 22, 0.08);   /* Muted background */
    --primary-bg-light: rgba(249, 115, 22, 0.1);    /* Light background */
    --primary-bg-medium: rgba(249, 115, 22, 0.15);  /* Medium background */
    --primary-border-alpha: rgba(249, 115, 22, 0.4);/* Semi-transparent border */

    /* Success (green) tints */
    --success-bg-faint: rgba(74, 222, 128, 0.05);   /* Very subtle background */
    --success-bg-light: rgba(74, 222, 128, 0.1);    /* Light background */
    --success-bg-medium: rgba(74, 222, 128, 0.15);  /* Medium background */

    /* Warning (amber) tints */
    --warning-bg-light: rgba(251, 191, 36, 0.1);    /* Light background */
    --warning-bg-medium: rgba(251, 191, 36, 0.15);  /* Medium background */
    --warning-bg-strong: rgba(251, 191, 36, 0.3);   /* Strong background */

    /* Error (red) tints */
    --error-bg-light: rgba(239, 68, 68, 0.1);       /* Light background */
    --error-bg-medium: rgba(239, 68, 68, 0.2);      /* Medium background */

    /* Overlay (black) tints */
    --overlay-light: rgba(0, 0, 0, 0.3);            /* Light overlay */
    --overlay-medium: rgba(0, 0, 0, 0.5);           /* Medium overlay */
    --overlay-heavy: rgba(0, 0, 0, 0.7);            /* Heavy overlay */
    --overlay-strong: rgba(0, 0, 0, 0.8);           /* Strong overlay */

    /* LCD dim border alpha */
    --lcd-dim-alpha: rgba(34, 84, 61, 0.5);         /* LCD dim at 50% opacity */

    /* -----------------------------------------
       SPACING - Based on 8pt grid
       Use these tokens, never hardcode values
       ----------------------------------------- */
    --space-2xs: 2px;      /* Fine detail: segment gaps, icon spacing */
    --space-xs: 4px;       /* Tight: tag gaps, inline spacing */
    --space-sm: 8px;       /* Standard: component padding, gaps */
    --space-md: 16px;      /* Section: card padding, form groups */
    --space-lg: 24px;      /* Major: section gaps, large padding */
    --space-xl: 32px;      /* Page: main content padding */
    --space-2xl: 48px;     /* Hero: dashboard spacing */

    /* Legacy rem-based spacing (for backward compatibility) */
    /* Prefer px-based tokens above for new code */

    /* -----------------------------------------
       BORDERS
       ----------------------------------------- */
    --border-width-sm: 1px;   /* Internal: separators, inputs, table cells */
    --border-width-md: 2px;   /* Containers: cards, panels, buttons, modals */
    --border-width-accent: 3px;  /* Accent/indicator borders */

    /* -----------------------------------------
       LAYOUT - Fixed dimensions
       ----------------------------------------- */
    --sidebar-width: 450px;      /* Release panel sidebar */
    --crate-panel-width: 420px;  /* Crate edit panel */

    /* -----------------------------------------
       SIZING - Component dimensions
       ----------------------------------------- */
    /* Icon sizes */
    --icon-sm: 14px;             /* Crate badges on cards */
    --icon-base: 16px;           /* Inline icons, dropdown emoji */
    --icon-md: 18px;             /* Action buttons, inline icons */
    --icon-lg: 20px;             /* Standalone icons, grid pickers */
    --icon-xl: 24px;             /* Large icon display */
    --icon-2xl: 32px;            /* Large icon buttons, emoji grid */
    --icon-3xl: 40px;            /* Icon previews */
    --icon-4xl: 64px;            /* Large icons, avatars */

    /* Button/control sizes */
    --btn-sm-size: 28px;         /* Small square buttons (toggle, mini actions) */
    --btn-discogs-width: 40px;   /* Discogs action button width */

    /* Input sizes */
    --input-sm-width: 36px;      /* BPM/Key input fields */

    /* Track layout */
    --track-toggle-width: 30px;  /* Toggle checkbox area width */
    --track-indent: calc(var(--track-toggle-width) + var(--space-sm));  /* Fields indentation */

    /* Table column widths */
    --col-pos-width: 60px;        /* Track position column */
    --col-duration-width: 70px;   /* Duration column */
    --col-field-width: 80px;      /* BPM, Key, Energy columns */
    --col-playable-width: 70px;   /* Playable toggle column */
    --col-title-min: 200px;       /* Minimum title column width */
    --col-tags-min: 150px;        /* Minimum tags column width */

    /* Cover sizes */
    --cover-lg: 250px;            /* Large cover (release detail) */
    --cover-md: 200px;            /* Medium cover (responsive) */
    --cover-sm: 100px;            /* Small cover (sidebar) */
    --cover-xs: 50px;             /* Mini cover (list items) */

    /* Color swatch sizes */
    --swatch-size: 22px;          /* Color picker swatches */

    /* Slider/control sizes */
    --slider-width: 50px;         /* Energy slider width */
    --slider-height: 4px;         /* Slider track height */
    --slider-thumb: 10px;         /* Slider thumb size */

    /* Toggle switch sizes */
    --toggle-width: 44px;         /* Standard toggle width */
    --toggle-height: 24px;        /* Standard toggle height */
    --toggle-thumb: 16px;         /* Toggle knob size */
    --toggle-travel: 20px;        /* How far thumb moves */
    --toggle-mini-width: 28px;    /* Mini toggle width */
    --toggle-mini-height: 16px;   /* Mini toggle height */
    --toggle-mini-thumb: 10px;    /* Mini toggle knob size */
    --toggle-mini-travel: 12px;   /* Mini toggle travel distance */

    /* LED indicator sizes */
    --led-size: 8px;              /* LED indicator dots */
    --led-size-sm: 6px;           /* Small LED indicators */

    /* Container max-widths */
    --max-width-page: 1400px;     /* Page content max width */
    --max-width-narrow: 600px;    /* Narrow forms/content */
    --max-width-sidebar: 400px;   /* Sidebar dropdowns */
    --max-width-card: 280px;      /* Card min width */

    /* Grid card sizing (for auto-fill grids) */
    --grid-card-min: 160px;       /* Standard card min width */
    --grid-card-max: 200px;       /* Standard card max width */
    --grid-card-sm-min: 130px;    /* Small card min (responsive) */
    --grid-card-sm-max: 160px;    /* Small card max (responsive) */
    --grid-card-lg-min: 200px;    /* Large card min (crates) */
    --grid-card-lg-max: 260px;    /* Large card max (crates) */
    --grid-dashboard-min: 180px;  /* Dashboard card min */
    --grid-dashboard-max: 240px;  /* Dashboard card max */
    --grid-picker-min: 32px;      /* Color/emoji picker item */

    /* Energy bar sizing */
    --energy-bar-height: 18px;    /* Energy bar component height */
    --energy-bar-sm-height: 14px; /* Small energy bar height */
    --energy-segment-width: 14px; /* Energy segment width */
    --energy-segment-sm-width: 10px; /* Small energy segment width */

    /* -----------------------------------------
       TYPOGRAPHY
       ----------------------------------------- */
    --font-mono: 'JetBrains Mono', 'Fira Code', 'SF Mono', 'Consolas', monospace;

    /* Font sizes - complete scale with no gaps */
    --text-4xs: 0.5rem;    /* 7px - extreme tiny (rare) */
    --text-3xs: 0.55rem;   /* 7.7px - micro labels, tiny tags */
    --text-micro: 0.6rem;  /* 8.4px - micro UI text */
    --text-2xs: 0.65rem;   /* 9px - tiny labels, badge text */
    --text-xxs: 0.7rem;    /* 9.8px - very small UI text */
    --text-xs: 0.75rem;    /* 10.5px - small text, badges */
    --text-caption: 0.8rem;/* 11.2px - captions, stats */
    --text-sm: 0.85rem;    /* 12px - secondary text */
    --text-body: 0.9rem;   /* 12.6px - small body, inputs */
    --text-base: 1rem;     /* 14px - body text */
    --text-md: 1.1rem;     /* 15.4px - slightly larger body */
    --text-lg: 1.125rem;   /* 16px - emphasis */
    --text-subhead: 1.2rem;/* 16.8px - subheadings */
    --text-heading: 1.25rem;/* 17.5px - small headings */
    --text-xl: 1.5rem;     /* 21px - headings */
    --text-2xl: 2rem;      /* 28px - page titles */

    /* Letter spacing */
    --tracking-tight: 0.02em;   /* Tight: dense text, position labels */
    --tracking-normal: 0.05em;  /* Standard: uppercase labels, buttons */
    --tracking-wide: 0.08em;    /* Wide: nav links, small caps */
    --tracking-wider: 0.1em;    /* Widest: section headings, emphasis */

    /* Line height (leading) */
    --leading-none: 1;          /* Icons, single-line elements */
    --leading-tight: 1.2;       /* Compact text, headings */
    --leading-snug: 1.3;        /* Slightly tight */
    --leading-normal: 1.5;      /* Standard readable text */
    --leading-relaxed: 1.6;     /* Body text, long-form reading */

    /* Font weights */
    --weight-normal: 400;       /* Normal/regular text */
    --weight-medium: 500;       /* Medium emphasis */
    --weight-semibold: 600;     /* Semi-bold, labels, buttons */
    --weight-bold: 700;         /* Bold, headings, strong emphasis */

    /* -----------------------------------------
       BREAKPOINTS
       Responsive design breakpoints
       NOTE: CSS vars can't be used in @media queries,
       so these serve as documentation/reference.
       Always update both the token AND the media query.
       ----------------------------------------- */
    --bp-sm: 768px;             /* Mobile/small screens */
    --bp-md: 900px;             /* Tablets/medium screens */
    --bp-lg: 1100px;            /* Small desktop */
    --bp-xl: 1200px;            /* Large desktop */

    /* -----------------------------------------
       Z-INDEX SCALE
       Layering system for stacking contexts
       ----------------------------------------- */
    --z-base: 0;                /* Base level, resets stacking */
    --z-raised: 1;              /* Slightly raised elements */
    --z-above: 5;               /* Above siblings (tabs, positioned) */
    --z-dropdown: 10;           /* Dropdowns, tooltips */
    --z-popover: 20;            /* Popovers, floating elements */
    --z-fixed: 50;              /* Fixed position elements */
    --z-sticky: 100;            /* Sticky headers, toolbars */
    --z-overlay: 900;           /* Overlays, backdrops */
    --z-modal: 1000;            /* Modals, dialogs (highest) */

    /* -----------------------------------------
       SHADOWS
       Functional shadows for hardware depth
       ----------------------------------------- */
    --shadow-inset-sm: inset 0 1px 2px rgba(0, 0, 0, 0.2);  /* Light inset */
    --shadow-inset: inset 0 1px 2px rgba(0, 0, 0, 0.3);     /* Standard inset */
    --shadow-inset-lcd: inset 0 1px 3px rgba(0, 0, 0, 0.3); /* LCD/recessed effect */
    --shadow-edge: 0 1px 0 rgba(0, 0, 0, 0.2);              /* Bottom edge depth */
    --shadow-focus: 0 0 0 1px var(--primary-dim);           /* Focus ring (primary) */
    --shadow-focus-success: 0 0 0 1px var(--success);       /* Focus ring (success) */

    /* -----------------------------------------
       FILTERS
       Visual effects for icons and images
       ----------------------------------------- */
    --filter-invert: invert(1);   /* White icons on dark background */

    /* -----------------------------------------
       TRANSITIONS
       Animation durations for consistent motion
       ----------------------------------------- */
    --duration-fast: 0.1s;      /* Micro interactions, quick feedback */
    --duration-base: 0.15s;     /* Standard transitions */
    --duration-moderate: 0.2s;  /* Slightly longer animations */
    --duration-slow: 0.3s;      /* Large movements, panels */
    --duration-blink: 0.6s;     /* LED blink, activity indicators */
    --duration-spin: 1s;        /* Spin/rotation animations */
    --duration-pulse: 2s;       /* Slow pulse animations */

    /* -----------------------------------------
       TRANSFORMS
       Scale and translate values for hover effects
       ----------------------------------------- */
    --scale-hover: 1.1;         /* Standard hover scale */
    --scale-hover-lg: 1.2;      /* Larger hover scale */
    --scale-hover-y: 1.15;      /* Vertical scale (energy bars) */
    --lift-hover: -4px;         /* Hover lift effect */
    --lift-hover-lg: -8px;      /* Larger hover lift */
    --tilt-crate-lid: -75deg;   /* Crate lid rotation */

    /* -----------------------------------------
       OPACITY
       Consistent transparency levels
       ----------------------------------------- */
    --opacity-disabled: 0.4;    /* Disabled buttons, inactive controls */
    --opacity-dim: 0.5;         /* Dimmed/inactive elements, separators */
    --opacity-faded: 0.6;       /* Slightly faded labels, secondary info */
    --opacity-muted: 0.7;       /* Muted text, hover states, loading */
    --opacity-moderate: 0.75;   /* Between muted and subtle */
    --opacity-subtle: 0.9;      /* Nearly full, subtle fade */

    /* -----------------------------------------
       CONSTRAINTS
       Max/min dimensions for common patterns
       ----------------------------------------- */
    --header-offset: 150px;             /* Header + toolbar offset for layouts */
    --dropdown-min-width: 180px;        /* Standard dropdown min-width */
    --dropdown-lg-min-width: 200px;     /* Large dropdown min-width */
    --dropdown-max-height: 250px;       /* Standard dropdown height */
    --dropdown-lg-max-height: 300px;    /* Large dropdown height */
    --textarea-min-height: 60px;        /* Minimum textarea height */
    --textarea-max-height: 100px;       /* Maximum textarea height */
    --textarea-base-height: 80px;       /* Standard textarea height */
    --icon-grid-max-height: 180px;      /* Icon/emoji picker grid height */
    --icon-grid-sm-max-height: 140px;   /* Small icon grid height */
    --list-max-height: 200px;           /* Scrollable list sections */
    --notes-compact-max-height: 120px;  /* Compact notes areas */
    --modal-sm-max-height: 120px;       /* Small modal/content area */
    --panel-loading-height: 200px;      /* Panel loading placeholder */
    --notes-lg-height: 250px;           /* Large notes textarea */
    --export-min-height: 400px;         /* Export preview min height */
    --table-cell-max-width: 200px;      /* Table cell truncation */
    --modal-panel-max-width: 350px;     /* Panel notes modal width */
    --setting-max-width: 500px;         /* Toggle setting row */
    --crate-name-max-width: 120px;      /* Crate name in cards */
    --energy-val-min-width: 12px;       /* Energy value display */

    /* -----------------------------------------
       LEGACY TOKENS (deprecated, use above)
       Kept for backward compatibility
       ----------------------------------------- */
    --radius-sm: 0;  /* MPC style: no rounded corners */
    --radius-md: 0;
    --radius-lg: 0;
}

/* Reset */
*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html {
    font-size: 14px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

body {
    font-family: var(--font-mono);
    background-color: var(--bg-body);
    color: var(--text-primary);
    line-height: var(--leading-relaxed);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Selection */
::selection {
    background-color: var(--primary);
    color: var(--bg-primary);
}

/* Links */
a {
    color: var(--primary);
    text-decoration: none;
    transition: color var(--duration-base) ease;
}

a:hover {
    color: var(--primary-hover);
}

/* =============================================
   COMPOSITION - Layout Primitives
   Page structure, grid systems, flex containers
   ============================================= */

/* --------------------------------------------
   NAVIGATION
   Hardware control panel style toolbar

   SPECS:
   - Height: auto (padding determines)
   - Padding: var(--space-md) var(--space-xl) = 16px 32px
   - Border bottom: var(--border-width-md) = 2px
   - Background: var(--bg-surface)
   -------------------------------------------- */

.nav {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-md) var(--space-xl);
    background-color: var(--bg-surface);
    /* Functional depth: light top edge, dark bottom edge (like hardware panel seam) */
    border-top: var(--border-width-sm) solid var(--bg-hover);
    border-bottom: var(--border-width-md) solid var(--border);
    box-shadow: var(--shadow-edge);
}

.nav-brand a {
    font-size: var(--text-md);
    font-weight: var(--weight-bold);
    color: var(--primary);
    text-decoration: none;
    letter-spacing: var(--tracking-wider);
    text-transform: uppercase;
}

.nav-links {
    display: flex;
    gap: var(--space-sm);
}

/* Chunky rectangular nav buttons with LED indicator */
.nav-links a {
    display: inline-flex;
    align-items: center;
    gap: var(--space-sm);
    color: var(--text-secondary);
    text-decoration: none;
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    letter-spacing: var(--tracking-wide);
    text-transform: uppercase;
    padding: var(--space-sm) var(--space-md);
    border: var(--border-width-md) solid var(--border);
    background: transparent;
    transition: background-color var(--duration-base) ease, color var(--duration-base) ease, border-color var(--duration-base) ease;
    /* Prevent layout shift on state change */
    min-width: max-content;
    text-rendering: geometricPrecision;
    -webkit-font-smoothing: antialiased;
}

/* LED indicator inside nav link */
.nav-links a .led {
    width: var(--led-size);
    height: var(--led-size);
    background: var(--border);
    border-radius: 50%; /* LED dots are round - mimics hardware */
    transition: background-color var(--duration-base) ease;
}

.nav-links a:hover {
    color: var(--text-primary);
    background-color: var(--bg-hover);
    border-color: var(--text-muted);
}

/* Active nav link with lit LED */
.nav-links a.active {
    color: var(--primary);
    border-color: var(--primary);
}

.nav-links a.active .led {
    background: var(--primary);
}

.nav-user {
    display: flex;
    align-items: center;
}

.user-link {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    text-decoration: none;
    color: var(--text-secondary);
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    letter-spacing: var(--tracking-wide);  /* Match nav-links for consistency */
    text-transform: uppercase;
    padding: var(--space-sm) var(--space-md);
    border: var(--border-width-md) solid var(--border);
    transition: background-color var(--duration-base) ease, color var(--duration-base) ease, border-color var(--duration-base) ease;
    /* Prevent layout shift on state change */
    min-width: max-content;
    text-rendering: geometricPrecision;
    -webkit-font-smoothing: antialiased;
}

/* LED indicator inside user link */
.user-link .led {
    width: var(--led-size);
    height: var(--led-size);
    background: var(--border);
    border-radius: 50%;
    transition: background-color var(--duration-base) ease;
}

.user-link:hover {
    color: var(--text-primary);
    background-color: var(--bg-hover);
    border-color: var(--text-muted);
}

.user-link.active {
    color: var(--primary);
    border-color: var(--primary);
}

.user-link.active .led {
    background: var(--primary);
}

/* ============================================
   MAIN CONTENT
   ============================================ */

.main {
    flex: 1;
    padding: var(--space-xl);
    max-width: var(--max-width-page);
    margin: 0 auto;
    width: 100%;
}

/* ============================================
   DASHBOARD - LCD Display Style
   ============================================ */

.dashboard {
    display: flex;
    flex-direction: column;
    gap: var(--space-2xl);
}

.dashboard-header {
    text-align: center;
    padding: var(--space-2xl) 0;
}

.dashboard-header h1 {
    font-size: var(--text-2xl);
    font-weight: var(--weight-bold);
    letter-spacing: var(--tracking-wider);
    text-transform: uppercase;
    margin-bottom: var(--space-sm);
    color: var(--primary);
}

.dashboard-header p {
    color: var(--text-secondary);
    font-size: var(--text-body);
    letter-spacing: var(--tracking-normal);
}

.dashboard-stats {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--grid-dashboard-min), var(--grid-dashboard-max)));
    gap: var(--space-md);
}

.stat-card {
    background-color: var(--lcd-bg);
    border: var(--border-width-md) solid var(--border);
    padding: var(--space-lg);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-xs);
    position: relative;
}

.stat-card::before {
    content: '';
    position: absolute;
    top: var(--space-2xs);
    left: var(--space-2xs);
    right: var(--space-2xs);
    height: var(--border-width-sm);
    background: linear-gradient(90deg, var(--lcd-dim), transparent);
}

.stat-value {
    font-size: var(--text-2xl);
    font-weight: var(--weight-bold);
    color: var(--lcd-text);
    font-variant-numeric: tabular-nums;
}

.stat-label {
    color: var(--lcd-dim);
    font-size: var(--text-xs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
}

.dashboard-actions {
    display: flex;
    justify-content: center;
    gap: var(--space-md);
}

/* =============================================
   BLOCKS - Component Styles
   ============================================= */

/* --------------------------------------------
   BUTTON
   MPC2000 pad-style buttons with depth effect

   SPECS:
   - Border: var(--border-width-md) = 2px
   - Padding default: var(--space-sm) var(--space-lg) = 8px 24px
   - Padding small: var(--space-xs) var(--space-sm) = 4px 8px
   - Font: 0.85rem (default), 0.75rem (small)
   - Min-height: ~36px (default), ~28px (small)

   VARIANTS:
   - .btn-primary: Orange fill, dark text
   - .btn-secondary: Elevated bg, light text
   - .btn-danger: Red border, fills on hover
   - .btn-sm: Smaller padding and font
   - .btn-icon: Square, for icon-only buttons

   STATES:
   - :hover: Background/border color shift
   - :active: Inverted depth (pressed effect)
   - :disabled: 0.4 opacity, no pointer
   - .is-loading: Add .activity-led child
   -------------------------------------------- */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-sm) var(--space-lg);
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    font-weight: var(--weight-semibold);
    text-decoration: none;
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
    border: var(--border-width-md) solid transparent;
    cursor: pointer;
    transition: background-color var(--duration-fast) ease, border-color var(--duration-fast) ease, color var(--duration-fast) ease, opacity var(--duration-fast) ease;
}

.btn-primary {
    background-color: var(--primary);
    color: var(--bg-primary);
    border-color: var(--primary);
    /* MPC2000 depth effect - lighter top, darker bottom */
    border-top-color: var(--primary-light);
    border-bottom-color: var(--primary-dark);
}

.btn-primary:hover {
    background-color: var(--primary-hover);
    border-color: var(--primary-hover);
    border-top-color: var(--primary-lighter);
    border-bottom-color: var(--primary-darker);
}

.btn-primary:active {
    /* Pressed state - invert depth */
    border-top-color: var(--primary-darker);
    border-bottom-color: var(--primary-lighter);
}

.btn-secondary {
    background-color: var(--bg-elevated);
    color: var(--text-primary);
    border-color: var(--border-light);
    /* MPC2000 depth effect */
    border-top-color: var(--neutral-light);
    border-bottom-color: var(--neutral-dark);
}

.btn-secondary:hover {
    border-color: var(--text-muted);
    background-color: var(--border);
    border-top-color: var(--neutral-lighter);
    border-bottom-color: var(--neutral-darker);
}

.btn-secondary:active {
    /* Pressed state - invert depth */
    border-top-color: var(--neutral-darker);
    border-bottom-color: var(--neutral-lighter);
}

.btn:disabled {
    opacity: var(--opacity-disabled);
    cursor: not-allowed;
}

.btn-sm {
    padding: var(--space-xs) var(--space-sm);
    font-size: var(--text-xs);
}

.btn-icon {
    padding: var(--space-xs);
    min-width: var(--btn-sm-size);
    height: var(--btn-sm-size);
}

.btn-block {
    width: 100%;
}

.btn-danger {
    background-color: var(--bg-elevated);
    color: var(--error);
    border-color: var(--error);
    /* MPC2000 depth effect with error color */
    border-top-color: var(--error-light);
    border-bottom-color: var(--error-dark);
}

.btn-danger:hover {
    background-color: var(--error);
    color: var(--bg-primary);
    border-color: var(--error);
    border-top-color: var(--error-lighter);
    border-bottom-color: var(--error-darker);
}

.btn-danger:active {
    /* Pressed state - invert depth */
    border-top-color: var(--error-darker);
    border-bottom-color: var(--error-lighter);
}

/* ============================================
   CARDS - Hardware Panel Style
   ============================================ */

.card {
    background-color: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    padding: var(--space-lg);
}

/* ============================================
   FORMS - Control Inputs
   ============================================ */

input, select, textarea {
    font-family: var(--font-mono);
    font-size: var(--text-body);
    padding: var(--space-sm) var(--space-md);
    background-color: var(--bg-input);
    border: var(--border-width-md) solid var(--border);
    color: var(--text-primary);
    width: 100%;
    transition: border-color var(--duration-base) ease;
}

input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: var(--shadow-focus);
}

input::placeholder, textarea::placeholder {
    color: var(--text-muted);
}

/* Form groups */
.form-group {
    margin-bottom: var(--space-md);
}

.form-group label {
    display: block;
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    margin-bottom: var(--space-xs);
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
}

/* ============================================
   Toggle Switch - MPC2000 style
   Chunky rectangular button with LED indicator
   ============================================ */

/* MPC-style toggle button (preferred) */
.toggle-btn {
    display: inline-flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-md);
    border: var(--border-width-md) solid var(--border);
    background: transparent;
    cursor: pointer;
    font-family: var(--font-mono);
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
    color: var(--text-secondary);
    transition: border-color var(--duration-base) ease, color var(--duration-base) ease;
}

.toggle-btn:hover {
    border-color: var(--text-muted);
    color: var(--text-primary);
}

/* Active/on state */
.toggle-btn.active {
    border-color: var(--success);
    color: var(--text-primary);
}

/* LED indicator inside toggle button */
.toggle-btn .led {
    width: var(--led-size);
    height: var(--led-size);
    background: var(--border);
    border-radius: 50%; /* LED dots are round - mimics hardware */
    transition: background-color var(--duration-base) ease;
}

.toggle-btn.active .led {
    background: var(--success);
}

/* Pressed effect */
.toggle-btn:active {
    box-shadow: var(--shadow-inset);
}

/* Toggle button with hidden checkbox - active via :has() */
.toggle-btn:has(input:checked) {
    border-color: var(--success);
    color: var(--text-primary);
}

.toggle-btn:has(input:checked) .led {
    background: var(--success);
}

/* MPC-style toggle switch (rectangular, no rounded corners) */
.toggle {
    position: relative;
    display: inline-block;
    width: var(--toggle-width);
    height: var(--toggle-height);
    vertical-align: middle;
}

.toggle input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    inset: 0;
    background-color: var(--border);
    transition: background-color var(--duration-base);
    border: var(--border-width-md) solid var(--border);
}

.toggle-slider::before {
    position: absolute;
    content: "";
    height: var(--toggle-thumb);
    width: var(--toggle-thumb);
    left: var(--space-2xs);
    bottom: var(--space-2xs);
    background-color: var(--text-muted);
    transition: transform var(--duration-base), background-color var(--duration-base);
    /* Square slider knob - MPC style */
}

.toggle input:checked + .toggle-slider {
    background-color: var(--primary-dim);
    border-color: var(--primary);
}

.toggle input:checked + .toggle-slider::before {
    transform: translateX(var(--toggle-travel));
    background-color: var(--primary);
}

/* Mini toggle - for compact sidebar track rows */
.toggle--mini {
    width: var(--toggle-mini-width);
    height: var(--toggle-mini-height);
}

.toggle--mini .toggle-slider {
    border-width: var(--border-width-sm);
}

.toggle--mini .toggle-slider::before {
    height: var(--toggle-mini-thumb);
    width: var(--toggle-mini-thumb);
    left: var(--space-2xs);
    bottom: var(--space-2xs);
}

.toggle--mini input:checked + .toggle-slider::before {
    transform: translateX(var(--toggle-mini-travel));
}

/* ============================================
   FOOTER
   ============================================ */

.footer {
    padding: var(--space-lg) var(--space-xl);
    text-align: center;
    color: var(--text-muted);
    font-size: var(--text-xs);
    letter-spacing: var(--tracking-wider);
    text-transform: uppercase;
    border-top: var(--border-width-md) solid var(--border);
}

/* ============================================
   UTILITY CLASSES
   ============================================ */

.text-muted { color: var(--text-muted); }
.text-secondary { color: var(--text-secondary); }
.text-success { color: var(--success); }
.text-warning { color: var(--warning); }
.text-error { color: var(--error); }
.hidden { display: none !important; }

/* Tags */
.tag {
    display: inline-flex;
    align-items: center;
    padding: var(--space-xs) var(--space-sm);
    font-size: var(--text-xxs);
    font-weight: var(--weight-semibold);
    background-color: var(--bg-elevated);
    border: var(--border-width-sm) solid var(--border);
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
}

.tag--primary {
    background-color: var(--primary-dim);
    border-color: var(--primary);
    color: var(--primary);
}

/* Page headers */
.page-header {
    margin-bottom: var(--space-xl);
}

.page-header h1 {
    font-size: var(--text-xl);
    font-weight: var(--weight-bold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    margin-bottom: var(--space-xs);
}

/* ============================================
   SYNC PAGE
   ============================================ */

.sync-page {
    max-width: var(--max-width-narrow);
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
}

.sync-card {
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
}

.sync-status {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    font-size: var(--text-body);
}

.status-indicator {
    width: var(--slider-thumb);
    height: var(--slider-thumb);
    background-color: var(--text-muted);
}

.status-indicator.status-running {
    background-color: var(--warning);
    animation: blink var(--duration-spin) step-end infinite;
}

.status-indicator.status-completed {
    background-color: var(--success);
}

.status-indicator.status-failed {
    background-color: var(--error);
}

.status-indicator.status-paused {
    background-color: var(--warning);
}

@keyframes blink {
    50% { opacity: 0.3; }
}

.sync-progress {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.progress-bar {
    height: var(--led-size-sm);
    background-color: var(--bg-input);
    border: var(--border-width-sm) solid var(--border);
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background-color: var(--primary);
    transition: width var(--duration-slow) ease;
}

.progress-text {
    font-size: var(--text-xs);
    color: var(--text-secondary);
    text-align: center;
    font-variant-numeric: tabular-nums;
}

.sync-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-md);
    text-align: center;
}

.sync-stat {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
    padding: var(--space-sm);
    background-color: var(--lcd-bg);
    border: var(--border-width-sm) solid var(--border);
}

.sync-stat-value {
    font-size: var(--text-heading);
    font-weight: var(--weight-bold);
    color: var(--lcd-text);
    font-variant-numeric: tabular-nums;
}

.sync-stat-label {
    font-size: var(--text-2xs);
    color: var(--lcd-dim);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
}

.sync-error {
    padding: var(--space-md);
    background-color: var(--error-bg-light);
    border: var(--border-width-md) solid var(--error);
    color: var(--error);
    font-size: var(--text-sm);
}

.sync-actions {
    display: flex;
    gap: var(--space-sm);
    justify-content: center;
}

.sync-info h2 {
    font-size: var(--text-sm);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    margin-bottom: var(--space-md);
}

.info-list {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.info-list li {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    padding-left: var(--space-lg);
    position: relative;
}

.info-list li::before {
    content: ">";
    position: absolute;
    left: 0;
    color: var(--primary);
    font-weight: bold;
}

/* Progress details */
.progress-details {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: var(--space-xs);
    font-size: var(--text-sm);
}

.progress-percent {
    font-weight: var(--weight-semibold);
    color: var(--lcd-text);
}

/* Current release being processed */
.current-release {
    margin-top: var(--space-md);
    padding: var(--space-sm) var(--space-md);
    background: var(--bg-surface);
    border-left: var(--border-width-accent) solid var(--primary);
    overflow: hidden;
}

.current-release-label {
    font-size: var(--text-xs);
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: var(--tracking-tight);
    display: block;
    margin-bottom: var(--space-xs);
}

.current-release-text {
    display: block;
    font-weight: var(--weight-medium);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    animation: pulse-text var(--duration-pulse) ease-in-out infinite;
}

@keyframes pulse-text {
    0%, 100% { opacity: 1; }
    50% { opacity: var(--opacity-muted); }
}

/* Live stats during sync */
.sync-live-stats {
    display: flex;
    gap: var(--space-sm);
    margin-top: var(--space-sm);
    font-size: var(--text-sm);
    color: var(--text-secondary);
}

.live-stat-value {
    font-weight: var(--weight-semibold);
    color: var(--lcd-text);
}

.live-stat-sep {
    opacity: var(--opacity-dim);
}

/* Enhanced error display */
.sync-error-header {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    margin-bottom: var(--space-sm);
}

.error-icon {
    font-size: var(--text-subhead);
}

.error-title {
    font-weight: var(--weight-semibold);
    color: var(--error);
}

.error-message {
    margin: 0 0 var(--space-sm) 0;
    font-family: monospace;
    font-size: var(--text-sm);
    background: var(--bg-surface);
    padding: var(--space-sm);
    word-break: break-word;
}

.error-hint {
    margin: 0;
    font-size: var(--text-caption);
    color: var(--text-secondary);
}

/* Activity LED - MPC2000 style blinking indicator for long-running operations
   Use for any button where user waits for a process to complete:
   - Sync operations (collection sync, inventory sync, release sync)
   - Import/export operations
   - Any async action that takes noticeable time
   The LED is hidden by default and appears blinking when .is-loading is added */
.activity-led {
    display: none;
    width: var(--led-size);
    height: var(--led-size);
    background: currentColor;
    border-radius: 50%; /* LED indicator - round is OK per MPC2000 guidelines */
    margin-right: var(--space-xs);
    animation: led-blink var(--duration-blink) ease-in-out infinite;
}

.btn.is-loading .activity-led {
    display: inline-block;
}

.btn.is-loading {
    opacity: var(--opacity-subtle);
    pointer-events: none;
}

@keyframes led-blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
}

/* Inventory notifications */
.inventory-notifications {
    border-left: var(--border-width-accent) solid var(--primary);
}

.notifications-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-sm);
}

.notifications-header h3 {
    margin: 0;
}

.notification-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
    margin-top: var(--space-md);
}

.notification-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-sm) var(--space-md);
    background: var(--bg-surface);
    gap: var(--space-md);
}

.notification-content {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    flex: 1;
    min-width: 0;
}

.notification-badge {
    padding: var(--space-2xs) var(--space-sm);
    font-size: var(--text-xxs);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-tight);
    flex-shrink: 0;
}

.badge-sold {
    background: var(--lcd-bg);
    color: var(--lcd-text);
}

.badge-removed {
    background: var(--error-bg-medium);
    color: var(--error);
}

.notification-details {
    display: flex;
    flex-direction: column;
    gap: var(--space-2xs);
    min-width: 0;
}

.notification-details strong {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.notification-actions {
    display: flex;
    gap: var(--space-xs);
    flex-shrink: 0;
}

/* Inventory sync section */
.inventory-sync-section {
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
    margin-top: var(--space-xl);
}

.inventory-sync-section .section-header {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.inventory-sync-section .section-header h2 {
    margin: 0;
}

.badge-seller {
    background: var(--lcd-bg);
    color: var(--lcd-text);
    padding: var(--space-2xs) var(--space-sm);
    font-size: var(--text-xxs);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-tight);
}

.inventory-note {
    font-size: var(--text-sm);
    margin-top: var(--space-md);
}

/* ============================================
   COLLECTION PAGE
   ============================================ */

/* Collection layout - sidebar pushes content */
.collection-layout {
    display: flex;
    gap: 0;
    position: relative;
    min-height: calc(100vh - var(--header-offset));
}

.collection-page {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
    transition: margin-right var(--duration-slow) ease-out;
}

.collection-page.panel-open {
    margin-right: var(--sidebar-width);
}

.collection-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap;
    gap: var(--space-md);
}

.collection-title h1 {
    font-size: var(--text-xl);
    font-weight: var(--weight-bold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    margin-bottom: var(--space-xs);
}

.collection-stats {
    display: flex;
    gap: var(--space-sm);
    font-size: var(--text-caption);
    color: var(--text-secondary);
    font-variant-numeric: tabular-nums;
}

.stat-divider {
    color: var(--text-muted);
}

.collection-toolbar {
    display: flex;
    gap: var(--space-md);
    flex-wrap: wrap;
    align-items: center;
}

.search-form {
    flex: 1;
    min-width: var(--col-title-min);
    max-width: var(--max-width-sidebar);
}

/* LCD-style search input */
.search-input {
    width: 100%;
    /* LCD-like inset shadow for recessed screen effect */
    box-shadow: var(--shadow-inset-lcd);
}

.search-input:focus {
    box-shadow: var(--shadow-inset-lcd), var(--shadow-focus);
}

.filter-buttons {
    display: flex;
    gap: var(--space-xs);
    align-items: stretch;
}

/* MPC2000-style filter buttons with LED indicator on active */
.filter-btn {
    position: relative;
    padding: var(--space-sm) var(--space-md);
    font-family: var(--font-mono);
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    color: var(--text-secondary);
    text-decoration: none;
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
    border: var(--border-width-md) solid var(--border);
    background: transparent;
    transition: background-color var(--duration-base) ease, color var(--duration-base) ease, border-color var(--duration-base) ease;
    cursor: pointer;
}

.filter-btn:hover {
    color: var(--text-primary);
    background-color: var(--bg-hover);
    border-color: var(--text-muted);
}

.filter-btn.active {
    color: var(--primary);
    border-color: var(--primary);
    background-color: transparent;
}

/* LED indicator dot for active filter */
.filter-btn.active::after {
    content: '';
    position: absolute;
    bottom: var(--space-xs);
    left: 50%;
    transform: translateX(-50%);
    width: var(--led-size-sm);
    height: var(--led-size-sm);
    background: var(--primary);
    border-radius: 50%; /* LED dots are round - mimics hardware */
}

/* Crate filter dropdown - MPC2000 style select */
.crate-filter-dropdown {
    display: inline-block;
}

.filter-select {
    padding: var(--space-sm) var(--space-md);
    font-family: var(--font-mono);
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
    border: var(--border-width-md) solid var(--border);
    background: transparent;
    cursor: pointer;
    transition: background-color var(--duration-base) ease, color var(--duration-base) ease, border-color var(--duration-base) ease;
}

.filter-select:hover {
    color: var(--text-primary);
    background-color: var(--bg-hover);
    border-color: var(--text-muted);
}

.filter-select:focus {
    outline: none;
    border-color: var(--primary);
    color: var(--primary);
}

.filter-select option {
    background: var(--bg-surface);
    color: var(--text-primary);
}

/* Crate badge in panel - rectangular, no rounded corners */
.crate-badge-panel {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-xs) var(--space-sm);
    font-size: var(--text-xs);
    background-color: var(--bg-elevated);
    border: var(--border-width-sm) solid var(--border);
    color: var(--text-secondary);
    text-decoration: none;
    transition: background-color var(--duration-base), border-color var(--duration-base);
}

.crate-badge-panel:hover {
    background-color: var(--bg-hover);
    border-color: var(--text-muted);
}

/* Release grid - fixed max-width so items reflow but don't resize when panel opens */
.releases-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--grid-card-min), var(--grid-card-max)));
    gap: var(--space-md);
}

.release-card {
    display: flex;
    flex-direction: column;
    text-decoration: none;
    color: inherit;
    overflow: hidden;
    background-color: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    transition: border-color var(--duration-base) ease;
}

.release-card:hover {
    border-color: var(--primary);
}

.release-cover {
    position: relative;
    aspect-ratio: 1;
    overflow: hidden;
    background-color: var(--bg-elevated);
}

/* Crate icons overlay on release cards - square MPC style */
.release-crate-icons {
    position: absolute;
    bottom: var(--space-xs);
    right: var(--space-xs);
    display: flex;
    gap: var(--space-2xs);
}

/* Base icon container - works for both emoji and pixel icons */
.release-crate-icon {
    width: var(--icon-lg);
    height: var(--icon-lg);
    background: var(--overlay-heavy);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-xxs);
    color: var(--text-primary); /* Default color for emoji icons */
}

/* Emoji icons on release cards - sized within container */
.release-crate-icon.emoji-icon {
    /* Override emoji-icon background since parent has dark bg */
    padding: var(--space-2xs);
}

.release-crate-more {
    width: var(--icon-lg);
    height: var(--icon-lg);
    background: var(--overlay-heavy);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-3xs);
    color: var(--text-muted);
}

.release-cover img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: grayscale(20%);
    transition: filter var(--duration-base) ease;
}

.release-card:hover .release-cover img {
    filter: grayscale(0%);
}

.cover-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    font-size: var(--text-xxs);
    text-transform: uppercase;
}

.release-info {
    padding: var(--space-sm);
    display: flex;
    flex-direction: column;
    gap: var(--space-2xs);
    background-color: var(--lcd-bg);
    flex: 1; /* Fill remaining card height so no grey gap shows */
}

/* Title row: title left, year right */
.release-title-row {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: var(--space-xs);
}

.release-title {
    font-size: var(--text-caption);
    font-weight: var(--weight-semibold);
    line-height: var(--leading-snug);
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    color: var(--lcd-text);
    flex: 1;
    min-width: 0;
}

.release-year {
    font-size: var(--text-caption);
    font-weight: var(--weight-semibold);
    color: var(--text-muted);
    flex-shrink: 0;
    line-height: var(--leading-snug);
}

.release-artist {
    font-size: var(--text-caption);
    font-weight: var(--weight-semibold);
    color: var(--lcd-text);
    opacity: var(--opacity-faded);  /* Slightly darker than title */
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Label row: label left, divider, catno right */
.release-label-row {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
}

.release-label {
    font-size: var(--text-2xs);
    font-weight: var(--weight-semibold);
    color: var(--text-secondary);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    flex: 1;
    min-width: 0;
}

.release-label-divider {
    width: var(--border-width-sm);
    height: 0.8em;
    background: var(--text-muted);
    opacity: var(--opacity-dim);
    flex-shrink: 0;
}

.release-catno {
    font-size: var(--text-2xs);
    font-weight: var(--weight-semibold);
    color: var(--text-secondary);
    flex-shrink: 0;
    text-align: right;
}

/* Pagination */
.pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-lg) 0;
}

.pagination-btn {
    padding: var(--space-sm) var(--space-md);
    font-family: var(--font-mono);
    font-size: var(--text-caption);
    color: var(--text-primary);
    text-decoration: none;
    border: var(--border-width-md) solid var(--border);
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
    transition: border-color var(--duration-base) ease, color var(--duration-base) ease;
}

.pagination-btn:hover {
    border-color: var(--primary);
    color: var(--primary);
}

.pagination-info {
    font-size: var(--text-caption);
    color: var(--text-secondary);
    font-variant-numeric: tabular-nums;
}

/* Empty state */
.empty-state {
    text-align: center;
    padding: var(--space-2xl);
    color: var(--text-secondary);
}

.empty-state h2 {
    font-size: var(--text-md);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    margin-bottom: var(--space-sm);
    color: var(--text-primary);
}

.empty-state p {
    margin-bottom: var(--space-lg);
}

/* ============================================
   RELEASE DETAIL PAGE
   ============================================ */

.release-detail {
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
}

.back-link {
    font-size: var(--text-caption);
    color: var(--text-secondary);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
}

.back-link:hover {
    color: var(--primary);
}

.back-link::before {
    content: "<";
    font-weight: bold;
}

.release-header {
    display: grid;
    grid-template-columns: auto 1fr auto;
    gap: var(--space-xl);
    align-items: start;
}

.release-cover-large {
    width: var(--cover-lg);
    height: var(--cover-lg);
    flex-shrink: 0;
    overflow: hidden;
    background-color: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
}

.release-cover-large img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.cover-placeholder-large {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    text-transform: uppercase;
    font-size: var(--text-caption);
}

.release-info-large {
    flex: 1;
    min-width: var(--max-width-card);
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.release-info-large h1 {
    font-size: var(--text-xl);
    font-weight: var(--weight-bold);
    line-height: var(--leading-tight);
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
}

.release-artist-large {
    font-size: var(--text-base);
    color: var(--text-secondary);
}

.release-meta-large {
    display: flex;
    gap: var(--space-md);
    font-size: var(--text-sm);
    color: var(--text-muted);
}

.release-stats {
    display: flex;
    gap: var(--space-sm);
    font-size: var(--text-caption);
    color: var(--text-secondary);
    margin-top: var(--space-sm);
    flex-wrap: wrap;
    align-items: center;
}

.avg-bpm {
    font-family: var(--font-mono);
    font-weight: var(--weight-semibold);
}

.bpm-varied {
    color: var(--warning);
    font-style: italic;
}

.release-actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-md);
    margin-bottom: var(--space-sm);
}

/* Tracks section - LCD table style */
.tracks-section {
    background-color: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    overflow: hidden;
}

.tracks-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-sm) var(--space-md);
    background-color: var(--bg-elevated);
    border-bottom: var(--border-width-md) solid var(--border);
}

.tracks-header h2 {
    font-size: var(--text-sm);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
}

.save-indicator {
    font-size: var(--text-xs);
    transition: color var(--duration-base) ease;
}

.save-indicator.saving { color: var(--warning); }
.save-indicator.saved { color: var(--success); }
.save-indicator.error { color: var(--error); }

.tracks-table-wrapper {
    overflow-x: auto;
}

.tracks-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--text-sm);
}

.tracks-table th {
    text-align: left;
    padding: var(--space-sm) var(--space-md);
    font-weight: var(--weight-semibold);
    color: var(--text-muted);
    font-size: var(--text-xxs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    background-color: var(--lcd-bg);
    border-bottom: var(--border-width-sm) solid var(--border);
}

.tracks-table td {
    padding: var(--space-sm) var(--space-md);
    border-bottom: var(--border-width-sm) solid var(--border);
    vertical-align: middle;
}

.tracks-table tbody tr:last-child td {
    border-bottom: none;
}

/* Track rows - no border collapse to maintain consistent line thickness */
.track-row {
    border-left: var(--border-width-sm) solid var(--border);
    border-right: var(--border-width-sm) solid var(--border);
    border-bottom: var(--border-width-sm) solid var(--border);
    transition: background-color var(--duration-base) ease, opacity var(--duration-base) ease;
}

.track-row:first-child {
    border-top: var(--border-width-sm) solid var(--border);
}

.track-row:hover {
    background-color: var(--bg-elevated);
}

/* Playable tracks get orange left/right borders, grey top/bottom for consistent separation */
.track-row.track-playable {
    background-color: var(--primary-bg-faint);
    border-left-color: var(--primary-border-alpha);
    border-right-color: var(--primary-border-alpha);
}

/* First playable track gets orange top border */
.track-row.track-playable:first-child {
    border-top-color: var(--primary-border-alpha);
}

/* Non-playable followed by playable: make its bottom border orange (this IS the top edge of the playable section) */
.track-row:not(.track-playable):has(+ .track-row.track-playable) {
    border-bottom-color: var(--primary-border-alpha);
}

/* Last playable in a group (not followed by another playable) gets orange bottom border */
.track-row.track-playable:not(:has(+ .track-row.track-playable)) {
    border-bottom-color: var(--primary-border-alpha);
}

/* Adjacent playable tracks: inset gray separator that doesn't overlap orange side borders */
.track-row.track-playable:has(+ .track-row.track-playable) {
    position: relative;
    border-bottom-color: transparent;
}

.track-row.track-playable:has(+ .track-row.track-playable)::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: var(--border-width-sm);
    background: var(--border);
}

.track-row.track-playable:hover {
    background-color: var(--primary-bg-subtle);
}

/* Non-playable tracks are dimmed */
.track-row:not(.track-playable) {
    opacity: var(--opacity-dim);
}

.track-row:not(.track-playable):hover {
    opacity: var(--opacity-muted);
}

.col-pos {
    width: var(--col-pos-width);
    color: var(--primary);
    font-weight: var(--weight-semibold);
}

.col-title { min-width: var(--col-title-min); }

.track-title { font-weight: var(--weight-medium); }

.track-notes-indicator {
    display: inline-block;
    margin-left: var(--space-sm);
    padding: var(--space-2xs) var(--space-xs);
    font-size: var(--text-2xs);
    color: var(--warning);
    background-color: var(--warning-bg-medium);
    cursor: pointer;
    text-transform: uppercase;
    transition: background-color var(--duration-base);
}

.track-notes-indicator:hover {
    background-color: var(--warning-bg-strong);
}

.col-duration {
    width: var(--col-duration-width);
    color: var(--text-muted);
    font-variant-numeric: tabular-nums;
}

.col-bpm, .col-key, .col-energy {
    width: var(--col-field-width);
}

.col-playable {
    width: var(--col-playable-width);
    text-align: center;
    vertical-align: middle;
}

.col-playable .toggle {
    margin: 0 auto;
}

/* Track input styling */
.track-input {
    width: 100%;
    padding: var(--space-xs) var(--space-sm);
    font-family: var(--font-mono);
    font-size: var(--text-caption);
    background-color: transparent;
    border: var(--border-width-sm) solid transparent;
    text-align: center;
}

.track-input:hover {
    background-color: var(--bg-input);
    border-color: var(--border);
}

.track-input:focus {
    background-color: var(--bg-input);
    border-color: var(--primary);
}

/* Energy slider styling */
.energy-slider-container {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    justify-content: center;
}

.track-energy-slider {
    width: var(--slider-width);
    height: var(--slider-height);
    -webkit-appearance: none;
    appearance: none;
    background: var(--border);
    /* No border-radius - MPC style */
    cursor: pointer;
}

.track-energy-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: var(--slider-thumb);
    height: var(--slider-thumb);
    /* Square thumb - MPC style */
    background: var(--primary);
    cursor: pointer;
    transition: transform var(--duration-base);
}

.track-energy-slider::-webkit-slider-thumb:hover {
    transform: scale(var(--scale-hover-lg));
}

.track-energy-slider::-moz-range-thumb {
    width: var(--slider-thumb);
    height: var(--slider-thumb);
    /* Square thumb - MPC style */
    background: var(--primary);
    border: none;
    cursor: pointer;
}

.energy-value {
    font-family: var(--font-mono);
    font-size: var(--text-caption);
    min-width: var(--icon-base);
    text-align: center;
    color: var(--text-muted);
}

.col-energy {
    width: var(--cover-sm);
}

.track-input::placeholder {
    color: var(--text-muted);
}

.track-input[type="number"]::-webkit-inner-spin-button,
.track-input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

.track-input[type="number"] {
    -moz-appearance: textfield;
}

/* Column settings modal */
.tracks-header-actions {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.column-settings-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.column-setting {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-xs) 0;
    cursor: pointer;
    font-size: var(--text-sm);
}

.column-setting input[type="checkbox"] {
    width: auto;
    margin: 0;
}

.column-setting input:disabled + span {
    color: var(--text-muted);
}

/* Release notes simple - size variant for detail page */
.release-notes-simple {
    width: var(--max-width-sidebar);
    height: var(--notes-lg-height);
}

/* Notes modal textareas - MPC2000 rectangular, no border-radius */
#release-notes-textarea,
#track-notes-textarea {
    width: 100%;
    padding: var(--space-sm);
    border: var(--border-width-sm) solid var(--border);
    background: var(--bg-input);
    color: var(--text);
    font-family: inherit;
    font-size: var(--text-body);
    resize: vertical;
}

.track-notes-title {
    font-weight: var(--weight-medium);
    margin-bottom: var(--space-sm);
    color: var(--text-secondary);
}

/* Track notes add button - MPC2000 rectangular, no border-radius */
.track-notes-add {
    display: inline-block;
    padding: var(--space-2xs) var(--space-xs);
    font-size: var(--text-2xs);
    color: var(--text-muted);
    border: var(--border-width-sm) dashed var(--border);
    cursor: pointer;
    opacity: 0;
    transition: opacity var(--duration-base);
}

.track-row:hover .track-notes-add {
    opacity: 1;
}

.track-notes-add:hover {
    border-color: var(--text-muted);
    color: var(--text-secondary);
}

/* Additional release info badges */
.release-extra-info {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
    margin-top: var(--space-sm);
}

.release-extra-info span {
    display: inline-block;
    padding: var(--space-2xs) var(--space-sm);
    font-size: var(--text-xxs);
    color: var(--text-secondary);
    background: var(--bg-elevated);
    border: var(--border-width-sm) solid var(--border);
}

.release-format {
    border-left: var(--border-width-md) solid var(--primary) !important;
}

.release-genre {
    border-left: var(--border-width-md) solid var(--success) !important;
}

.release-style {
    border-left: var(--border-width-md) solid var(--warning) !important;
}

/* Responsive: stack notes below on smaller screens (--bp-lg) */
@media (max-width: 1100px) {
    .release-header {
        grid-template-columns: auto 1fr;
    }
    .release-notes-panel {
        grid-column: 1 / -1;
        width: 100%;
    }
}

/* ============================================
   CRATES
   ============================================ */

.crates-page {
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
}

.crates-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.crates-header h1 {
    font-size: var(--text-xl);
    font-weight: var(--weight-bold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    margin-bottom: var(--space-xs);
}

/* Crate tree */
.crates-tree {
    display: flex;
    flex-direction: column;
    border: var(--border-width-md) solid var(--border);
    background-color: var(--bg-surface);
}

.crate-item {
    display: flex;
    align-items: center;
    padding: var(--space-sm) var(--space-md);
    padding-left: calc(var(--space-md) + calc(var(--depth, 0) * var(--space-lg)));
    border-bottom: var(--border-width-sm) solid var(--border);
    transition: background-color var(--duration-base) ease;
}

.crate-item:last-child {
    border-bottom: none;
}

.crate-item:hover {
    background-color: var(--bg-elevated);
}

.crate-link {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    flex: 1;
    text-decoration: none;
    color: inherit;
}

.crate-icon {
    font-size: var(--text-base);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: var(--btn-sm-size);
    height: var(--btn-sm-size);
    /* No border-radius - MPC style */
}

.crate-name {
    font-weight: var(--weight-medium);
}

.crate-counts {
    display: flex;
    gap: var(--space-sm);
    margin-left: auto;
}

.count-badge {
    font-size: var(--text-xxs);
    color: var(--text-muted);
    font-variant-numeric: tabular-nums;
}

.crate-action {
    opacity: 0;
    padding: var(--space-xs) var(--space-sm);
    background: var(--bg-input);
    border: var(--border-width-sm) solid var(--border);
    color: var(--text-secondary);
    cursor: pointer;
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    transition: opacity var(--duration-base) ease, background-color var(--duration-base) ease, color var(--duration-base) ease, border-color var(--duration-base) ease;
}

.crate-item:hover .crate-action {
    opacity: 1;
}

.crate-action:hover {
    background: var(--primary);
    color: var(--bg-primary);
    border-color: var(--primary);
}

.crate-children {
    border-left: var(--border-width-md) solid var(--border);
    margin-left: var(--space-lg);
}

/* Crate detail page */
.crate-detail {
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    font-size: var(--text-caption);
}

.breadcrumbs a {
    color: var(--text-secondary);
    text-decoration: none;
}

.breadcrumbs a:hover {
    color: var(--primary);
}

.breadcrumb-sep {
    color: var(--text-muted);
}

.breadcrumb-current {
    color: var(--text-primary);
}

.crate-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: var(--space-md);
}

.crate-info h1 {
    font-size: var(--text-xl);
    font-weight: var(--weight-bold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
    margin-bottom: var(--space-xs);
}

.crate-description {
    color: var(--text-secondary);
    margin-bottom: var(--space-xs);
}

.crate-stats {
    font-size: var(--text-sm);
}

.crate-actions-header {
    display: flex;
    gap: var(--space-sm);
}

.crate-section {
    background-color: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    padding: var(--space-lg);
}

.crate-section h2 {
    font-size: var(--text-sm);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    margin-bottom: var(--space-md);
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* Sub-crates list */
.sub-crates-list {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-sm);
}

.sub-crate-card {
    display: flex;
    flex-direction: column;
    padding: var(--space-md);
    background-color: var(--bg-elevated);
    border: var(--border-width-md) solid var(--border);
    text-decoration: none;
    color: inherit;
    transition: border-color var(--duration-base) ease;
}

.sub-crate-card:hover {
    border-color: var(--primary);
}

.sub-crate-name { font-weight: var(--weight-medium); }
.sub-crate-count { font-size: var(--text-xs); color: var(--text-muted); }

/* Crate releases grid - fixed max-width so items reflow but don't resize */
.crate-releases-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--grid-card-lg-min), var(--grid-card-lg-max)));
    gap: var(--space-md);
}

.crate-release-card {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm);
    background-color: var(--bg-elevated);
    position: relative;
}

.crate-release-card .release-link {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    text-decoration: none;
    color: inherit;
    flex: 1;
    min-width: 0;
}

.release-cover-small {
    width: var(--cover-xs);
    height: var(--cover-xs);
    flex-shrink: 0;
    overflow: hidden;
    background-color: var(--bg-surface);
    border: var(--border-width-sm) solid var(--border);
}

.release-cover-small img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.cover-placeholder-small {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-4xs);
    color: var(--text-muted);
}

.release-info-small {
    display: flex;
    flex-direction: column;
    min-width: 0;
}

.release-title-small {
    font-size: var(--text-caption);
    font-weight: var(--weight-medium);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.release-artist-small {
    font-size: var(--text-xxs);
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.btn-remove {
    position: absolute;
    top: var(--space-xs);
    right: var(--space-xs);
    width: var(--icon-lg);
    height: var(--icon-lg);
    padding: 0;
    border: none;
    background: var(--bg-surface);
    color: var(--text-muted);
    cursor: pointer;
    opacity: 0;
    transition: opacity var(--duration-base) ease, background-color var(--duration-base) ease, color var(--duration-base) ease;
    font-size: var(--text-base);
    font-family: var(--font-mono);
    line-height: var(--leading-none);
}

.crate-release-card:hover .btn-remove,
.crate-track-item:hover .btn-remove {
    opacity: 1;
}

.btn-remove:hover {
    background: var(--error);
    color: var(--text-primary);
}

/* Crate tracks list */
.crate-tracks-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
}

.crate-track-item {
    display: flex;
    align-items: center;
    padding: var(--space-sm) var(--space-md);
    background-color: var(--bg-elevated);
    position: relative;
}

.crate-track-item .track-link {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    text-decoration: none;
    color: inherit;
    flex: 1;
}

.track-title-sm { font-weight: var(--weight-medium); }
.track-artist-sm { font-size: var(--text-caption); color: var(--text-secondary); }

.track-bpm-sm {
    font-size: var(--text-xs);
    color: var(--primary);
    margin-left: auto;
    font-variant-numeric: tabular-nums;
}

/* Crate badges on release page */
.release-crates {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
    margin-top: var(--space-sm);
}

.crate-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-xs) var(--space-sm);
    font-size: var(--text-xs);
    background-color: var(--bg-elevated);
    border: var(--border-width-sm) solid var(--border);
    /* No border-radius - MPC style */
    color: var(--text-secondary);
    text-decoration: none;
    transition: background-color var(--duration-base), border-color var(--duration-base);
}

.crate-badge:hover {
    background-color: var(--bg-hover);
    border-color: var(--text-muted);
}

.crate-badge-icon {
    font-size: var(--text-body);
}

.crate-badge-name {
    font-weight: var(--weight-medium);
}

/* Crate selector in modal */
.crate-selector {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
}

.crate-select-list {
    max-height: var(--dropdown-lg-max-height);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.crate-select-item {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-md);
    cursor: pointer;
    transition: background-color var(--duration-base) ease;
}

.crate-select-item:hover {
    background-color: var(--bg-elevated);
}

.crate-select-item input[type="checkbox"] {
    width: auto;
    margin: 0;
}

.crate-selector-footer {
    padding-top: var(--space-md);
    border-top: var(--border-width-sm) solid var(--border);
    text-align: center;
}

.crate-selector-footer a {
    font-size: var(--text-caption);
}

/* Crates page layout - sidebar pushes content */
.crates-page-layout {
    display: flex;
    position: relative;
}

.crates-main {
    flex: 1;
    min-width: 0;
    transition: padding-right var(--duration-slow) ease;
}

body.crate-panel-open .crates-main {
    padding-right: var(--crate-panel-width);
}

/* Crate grid - square cards with fixed max-width so items reflow but don't resize */
.crates-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--grid-card-min), var(--grid-card-max)));
    gap: var(--space-md);
}

/* Stylised crate box */
.crate-box {
    position: relative;
    aspect-ratio: 1;
    display: flex;
    flex-direction: column;
    text-decoration: none;
    color: inherit;
    background: linear-gradient(135deg, var(--crate-wood-mid) 0%, var(--crate-wood-dark) 100%);
    border: var(--border-width-md) solid var(--crate-wood-light);
    overflow: hidden;
    transition: transform var(--duration-moderate), border-color var(--duration-moderate);
    --crate-accent: var(--primary);
}

.crate-box:hover {
    transform: translateY(var(--lift-hover));
    border-color: var(--crate-accent);
}

/* Sub-crate indicator */
.crate-box.sub-crate::before {
    content: '';
    position: absolute;
    top: var(--space-xs);
    left: var(--space-xs);
    font-size: var(--text-xxs);
    color: var(--text-muted);
    z-index: var(--z-above);
}

/* Crate lid - opens on hover */
.crate-lid {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: var(--btn-sm-size);
    background: linear-gradient(180deg, var(--crate-wood-light) 0%, var(--crate-wood-mid) 100%);
    border-bottom: var(--border-width-md) solid var(--crate-wood-dark);
    transform-origin: top center;
    transition: transform var(--duration-slow) ease;
    z-index: 3; /* Component-internal layering (below badge) */
    display: flex;
    align-items: center;
    justify-content: center;
}

.crate-lid-inner {
    background: var(--crate-wood-dark);
    padding: var(--space-2xs) var(--space-sm);
    /* No border-radius - MPC style */
}

.crate-lid-label {
    font-size: var(--text-3xs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
    color: var(--crate-accent);
    font-weight: var(--weight-semibold);
}

.crate-box:hover .crate-lid {
    transform: rotateX(var(--tilt-crate-lid)) translateY(var(--lift-hover-lg));
}

/* Crate body */
.crate-body {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--space-md);
    padding-top: var(--space-xl);
    position: relative;
    z-index: var(--z-raised);
}

.crate-icon-container {
    width: var(--space-2xl);
    height: var(--space-2xl);
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--overlay-light);
    /* No border-radius - MPC style */
    margin-bottom: var(--space-sm);
}

.crate-emoji {
    font-size: var(--text-xl);
}

.crate-box .crate-info {
    text-align: center;
}

.crate-box .crate-name {
    display: block;
    font-size: var(--text-caption);
    font-weight: var(--weight-semibold);
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: var(--crate-name-max-width);
    margin-bottom: var(--space-2xs);
}

.crate-box .crate-stats {
    font-size: var(--text-2xs);
    color: var(--text-muted);
}

/* Crate slats (decorative wooden slats) */
.crate-slat {
    position: absolute;
    left: 0;
    right: 0;
    height: var(--space-2xs);
    background: linear-gradient(90deg,
        transparent 0%,
        var(--crate-wood-light) 10%,
        var(--crate-wood-light) 90%,
        transparent 100%);
    z-index: var(--z-base);
}

.crate-slat-1 {
    bottom: 30%;
}

.crate-slat-2 {
    bottom: 60%;
}

/* Hover actions */
.crate-hover-actions {
    position: absolute;
    bottom: var(--space-sm);
    right: var(--space-sm);
    display: flex;
    gap: var(--space-xs);
    opacity: 0;
    transition: opacity var(--duration-base);
    z-index: var(--z-dropdown);
}

.crate-box:hover .crate-hover-actions {
    opacity: 1;
}

.crate-action-btn {
    width: var(--icon-xl);
    height: var(--icon-xl);
    padding: 0;
    border: var(--border-width-sm) solid var(--border);
    background: var(--bg-surface);
    color: var(--text-secondary);
    cursor: pointer;
    font-size: var(--text-xs);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color var(--duration-base) ease, border-color var(--duration-base) ease, color var(--duration-base) ease;
}

.crate-action-btn:hover {
    background: var(--crate-accent);
    border-color: var(--crate-accent);
    color: var(--bg-primary);
}

/* Crate edit sidebar */
.crate-panel {
    position: fixed;
    top: 0;
    right: 0;
    width: var(--crate-panel-width);
    height: 100vh;
    background: var(--bg-surface);
    border-left: var(--border-width-md) solid var(--border);
    z-index: var(--z-overlay);
    transform: translateX(100%);
    transition: transform var(--duration-slow) ease;
    overflow-y: auto;
}

.crate-panel.open {
    transform: translateX(0);
}

.crate-panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-md);
    border-bottom: var(--border-width-md) solid var(--border);
    position: sticky;
    top: 0;
    background: var(--bg-surface);
}

.crate-panel-header h3 {
    margin: 0;
    font-size: var(--text-body);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
}

.crate-panel-content {
    padding: var(--space-md);
}

/* Icon/color picker styles */
.icon-picker-container {
    margin-top: var(--space-xs);
}

.icon-input-row {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    margin-bottom: var(--space-sm);
}

.icon-preview {
    width: var(--input-sm-width);
    height: var(--input-sm-width);
    border: var(--border-width-md) solid var(--border);
    /* No border-radius - MPC style */
    background: var(--bg-elevated);
    cursor: pointer;
    font-size: var(--text-subhead);
    display: flex;
    align-items: center;
    justify-content: center;
}

.icon-text-input {
    flex: 1;
    max-width: var(--cover-sm);
    padding: var(--space-xs);
    border: var(--border-width-sm) solid var(--border);
    /* No border-radius - MPC style */
    font-size: var(--text-base);
    text-align: center;
    background: var(--bg-input);
    color: var(--text-primary);
}

.icon-suggestions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2xs);
}

.icon-suggestion {
    width: var(--btn-sm-size);
    height: var(--btn-sm-size);
    border: var(--border-width-sm) solid transparent;
    /* No border-radius - MPC style */
    background: var(--bg-elevated);
    cursor: pointer;
    font-size: var(--text-sm);
    display: flex;
    align-items: center;
    justify-content: center;
}

.icon-suggestion:hover {
    border-color: var(--border);
}

/* Emoji Icon Picker */
.icon-preview-box {
    width: var(--space-2xl);
    height: var(--space-2xl);
    border: var(--border-width-md) solid var(--border);
    /* No border-radius - MPC style */
    background: var(--bg-elevated);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

/* Constrain preview icon size */
.icon-preview-box .emoji-icon {
    font-size: var(--text-2xl);
}

.icon-preview-img {
    width: var(--icon-xl);
    height: var(--icon-xl);
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    filter: var(--filter-invert);
}

.icon-search-input {
    flex: 1;
    padding: var(--space-xs) var(--space-sm);
    border: var(--border-width-sm) solid var(--border);
    /* No border-radius - MPC style */
    background: var(--bg-input);
    color: var(--text-primary);
    font-family: inherit;
    font-size: var(--text-sm);
}

.icon-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--grid-picker-min), 1fr));
    gap: var(--space-2xs);
    max-height: var(--icon-grid-max-height);
    overflow-y: auto;
    padding: var(--space-xs);
    background: var(--bg-elevated);
    border: var(--border-width-sm) solid var(--border);
}

.icon-grid-sm {
    max-height: var(--icon-grid-sm-max-height);
}

.icon-grid-item {
    width: var(--icon-2xl);
    height: var(--icon-2xl);
    border: var(--border-width-sm) solid transparent;
    /* No border-radius - MPC style */
    background: transparent;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-xs);
}

.icon-grid-item:hover {
    border-color: var(--border);
    background: var(--bg-surface);
}

.icon-grid-item.selected {
    border-color: var(--primary);
    background: var(--bg-surface);
}

.icon-grid-item img {
    width: var(--icon-lg);
    height: var(--icon-lg);
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    filter: var(--filter-invert);
}

/* Pixel Icon Grid (for icon picker) */
.pixel-icon-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: var(--space-xs);
    padding: var(--space-sm);
    background: var(--bg-surface);
    border: var(--border-width-sm) solid var(--border);
    max-height: var(--icon-grid-max-height);
    overflow-y: auto;
}

.pixel-icon-grid-item {
    width: var(--input-sm-width);
    height: var(--input-sm-width);
    display: flex;
    align-items: center;
    justify-content: center;
    border: var(--border-width-sm) solid transparent;
    background: transparent;
    cursor: pointer;
    padding: 0;
}

.pixel-icon-grid-item:hover {
    border-color: var(--border);
    background: var(--bg-elevated);
}

.pixel-icon-grid-item.selected {
    border-color: var(--primary);
    background: var(--bg-elevated);
}

/* Emoji Icon Grid (for icon picker) */
.emoji-icon-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: var(--space-xs);
    padding: var(--space-sm);
    background: var(--bg-surface);
    border: var(--border-width-sm) solid var(--border);
    max-height: var(--icon-grid-max-height);
    overflow-y: auto;
}

.emoji-icon-grid-item {
    width: var(--icon-3xl);
    height: var(--icon-3xl);
    display: flex;
    align-items: center;
    justify-content: center;
    border: var(--border-width-sm) solid transparent;
    background: transparent;
    cursor: pointer;
    padding: var(--space-xs);
}

/* Constrain icon size within grid item */
.emoji-icon-grid-item .emoji-icon {
    font-size: var(--icon-lg);
}

.emoji-icon-grid-item:hover {
    border-color: var(--border);
    background: var(--bg-elevated);
}

.emoji-icon-grid-item.selected {
    border-color: var(--primary);
    background: var(--bg-elevated);
}

/* Pixel icons in crate cards */
.crate-pixel-icon {
    width: var(--icon-2xl);
    height: var(--icon-2xl);
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    filter: var(--filter-invert);
}

/* Large pixel icon on crate detail page */
.crate-pixel-icon-lg {
    width: var(--icon-3xl);
    height: var(--icon-3xl);
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    filter: var(--filter-invert);
}

/* Pixel icons on release cards (crate indicators) */
.release-crate-icon {
    width: var(--icon-sm);
    height: var(--icon-sm);
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    filter: var(--filter-invert) drop-shadow(0 0 1px rgba(0,0,0,0.5));
}

/* ============================================
   EMOJI ICONS (Noto Emoji Font)
   Google's monochrome emoji font with variable weight
   Color inheritance via CSS color property
   ============================================ */

/* Base emoji icon - uses Noto Emoji font (monochrome) */
.emoji-icon {
    display: inline-block;
    font-family: 'Noto Emoji';
    font-weight: var(--weight-medium); /* Medium weight */
    font-style: normal;
    font-size: var(--icon-xl); /* Default size (24px), override with size modifiers */
    line-height: var(--leading-none);
    /* Force text/monochrome presentation */
    font-variant-emoji: text;
    /* Centering within parent */
    vertical-align: middle;
    flex-shrink: 0;
    /* Prevent text selection */
    user-select: none;
    /* Smooth rendering */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Emoji icon size modifiers - use these instead of inline styles */
.emoji-icon--sm { font-size: var(--icon-sm); }      /* 14px */
.emoji-icon--base { font-size: var(--icon-base); }  /* 16px */
.emoji-icon--md { font-size: var(--icon-md); }      /* 18px */
.emoji-icon--lg { font-size: var(--icon-lg); }      /* 20px */
.emoji-icon--xl { font-size: var(--icon-xl); }      /* 24px - default */
.emoji-icon--2xl { font-size: var(--icon-2xl); }    /* 32px */
.emoji-icon--3xl { font-size: var(--icon-3xl); }    /* 40px */
.emoji-icon--4xl { font-size: var(--icon-4xl); }    /* 64px */

/* Emoji in crate cards */
.crate-emoji-icon {
    width: var(--icon-2xl);
    height: var(--icon-2xl);
}

/* Large emoji on crate detail page */
.crate-emoji-icon-lg {
    width: var(--icon-3xl);
    height: var(--icon-3xl);
}

/* Emoji on release cards (crate indicators) */
.release-emoji-icon {
    width: var(--icon-sm);
    height: var(--icon-sm);
}

/* Emoji in crate badges (release page, panel) - square MPC style */
.crate-badge-emoji {
    width: var(--icon-sm);
    height: var(--icon-sm);
    flex-shrink: 0;
}

/* Emoji in crate dropdown items */
.crate-dropdown-emoji {
    width: var(--icon-base);
    height: var(--icon-base);
    flex-shrink: 0;
}

/* Emoji in icon picker grid */
.emoji-grid-item {
    width: var(--icon-2xl);
    height: var(--icon-2xl);
    display: flex;
    align-items: center;
    justify-content: center;
    border: var(--border-width-sm) solid transparent;
    background: transparent;
    cursor: pointer;
    padding: var(--space-2xs);
}

.emoji-grid-item:hover {
    border-color: var(--border);
    background: var(--bg-surface);
}

.emoji-grid-item.selected {
    border-color: var(--primary);
    background: var(--bg-surface);
}

.emoji-grid-item img {
    width: var(--icon-xl);
    height: var(--icon-xl);
    /* Use filter for preview - actual icons use mask */
    filter: var(--filter-invert);
}

.color-picker {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
    margin-top: var(--space-xs);
}

.color-option {
    width: var(--swatch-size);
    height: var(--swatch-size);
    border: var(--border-width-md) solid transparent;
    /* Square color swatches - MPC style */
    cursor: pointer;
}

.color-option:hover {
    transform: scale(var(--scale-hover));
}

.color-option.selected {
    border-color: var(--text-primary);
}

.color-custom-label {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--swatch-size);
    height: var(--swatch-size);
    cursor: pointer;
    border: var(--border-width-md) solid var(--border);
    /* Square - MPC style */
}

.color-custom-icon {
    font-size: var(--text-xxs);
}

.color-custom input[type="color"] {
    position: absolute;
    width: 100%;
    height: 100%;
    opacity: 0;
    cursor: pointer;
}

/* Panel form styling */
.panel-form-group {
    margin-bottom: var(--space-md);
}

.panel-form-group label {
    display: block;
    font-size: var(--text-xxs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    color: var(--text-muted);
    margin-bottom: var(--space-xs);
}

.panel-form-group input[type="text"] {
    width: 100%;
    padding: var(--space-sm);
    border: var(--border-width-sm) solid var(--border);
    /* No border-radius - MPC style */
    background: var(--bg-input);
    color: var(--text-primary);
    font-family: inherit;
    font-size: var(--text-body);
}

.panel-actions {
    display: flex;
    gap: var(--space-sm);
    margin-top: var(--space-lg);
    padding-top: var(--space-md);
    border-top: var(--border-width-sm) solid var(--border);
}

.panel-actions .btn {
    flex: 1;
}

.panel-danger-zone {
    margin-top: var(--space-xl);
    padding-top: var(--space-md);
    border-top: var(--border-width-sm) solid var(--error);
}

.panel-danger-zone h4 {
    font-size: var(--text-xxs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    color: var(--error);
    margin-bottom: var(--space-sm);
}

/* Crate detail page - large icon */
.crate-icon-large {
    width: var(--icon-4xl);
    height: var(--icon-4xl);
    /* No border-radius - MPC style */
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-2xl);
    background: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    flex-shrink: 0;
}

/* Form select - standard dropdown styling */
.form-select {
    width: 100%;
    padding: var(--space-sm) var(--space-md);
    border: var(--border-width-sm) solid var(--border);
    /* No border-radius - MPC style */
    background: var(--bg-input);
    color: var(--text-primary);
    font-size: var(--text-body);
}

/* Responsive: crate detail layout (--bp-xl) */
@media (max-width: 1200px) {
    body.crate-panel-open .crates-main {
        padding-right: 0;
    }
}

/* ============================================
   MODAL
   ============================================ */

.modal {
    display: none;
    position: fixed;
    inset: 0;
    z-index: var(--z-modal);
}

.modal.open {
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-backdrop {
    position: absolute;
    inset: 0;
    background-color: var(--overlay-strong);
}

.modal-content {
    position: relative;
    background-color: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    padding: var(--space-lg);
    width: 100%;
    max-width: var(--max-width-sidebar);
    max-height: 80vh;
    overflow-y: auto;
}

.modal-content-sm {
    max-width: var(--max-width-card);
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-lg);
    padding-bottom: var(--space-sm);
    border-bottom: var(--border-width-sm) solid var(--border);
}

.modal-header h2 {
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
}

.modal-close {
    background: none;
    border: none;
    font-size: var(--text-xl);
    color: var(--text-muted);
    cursor: pointer;
    padding: 0;
    line-height: var(--leading-none);
    font-family: var(--font-mono);
}

.modal-close:hover {
    color: var(--primary);
}

.modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--space-sm);
    margin-top: var(--space-lg);
    padding-top: var(--space-md);
    border-top: var(--border-width-sm) solid var(--border);
}

.parent-badge {
    display: inline-block;
    padding: var(--space-xs) var(--space-sm);
    background-color: var(--bg-elevated);
    font-size: var(--text-caption);
}

/* ============================================
   TAGS
   ============================================ */

.col-tags { min-width: var(--col-tags-min); }

.track-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
    align-items: center;
}

.tag-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-2xs) var(--space-sm);
    font-size: var(--text-xxs);
    font-weight: var(--weight-semibold);
    background-color: var(--tag-color, var(--tag-default));
    color: var(--bg-primary);
    white-space: nowrap;
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
}

.tag-remove {
    background: none;
    border: none;
    color: inherit;
    cursor: pointer;
    padding: 0;
    margin-left: var(--space-2xs);
    font-size: var(--text-sm);
    line-height: var(--leading-none);
    opacity: 0;
    font-family: var(--font-mono);
    transition: opacity var(--duration-fast);
}

.tag-badge:hover .tag-remove {
    opacity: var(--opacity-muted);
}

.tag-remove:hover {
    opacity: 1;
}

.tag-add-btn {
    width: var(--swatch-size);
    height: var(--swatch-size);
    padding: 0;
    border: var(--border-width-sm) dashed var(--border-light);
    background: transparent;
    color: var(--text-muted);
    cursor: pointer;
    font-size: var(--text-sm);
    font-family: var(--font-mono);
    line-height: var(--leading-none);
    transition: border-color var(--duration-base) ease, color var(--duration-base) ease;
}

.tag-add-btn:hover {
    border-color: var(--primary);
    color: var(--primary);
}

.tag-input-wrapper {
    display: inline-flex;
}

.tag-input {
    width: var(--col-field-width);
    padding: var(--space-2xs) var(--space-xs);
    font-size: var(--text-xxs);
    background-color: var(--bg-input);
    border: var(--border-width-sm) solid var(--primary);
    color: var(--text-primary);
}

.tag-input:focus {
    outline: none;
}

/* ============================================
   EXPORT
   ============================================ */

.export-page {
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
}

.export-layout {
    display: grid;
    grid-template-columns: var(--max-width-card) 1fr;
    gap: var(--space-lg);
    align-items: start;
}

/* Responsive: sync page layout (--bp-md) */
@media (max-width: 900px) {
    .export-layout {
        grid-template-columns: 1fr;
    }
}

.export-sidebar {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
}

.export-section {
    background-color: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    padding: var(--space-md);
}

.export-section h3 {
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    margin-bottom: var(--space-md);
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
}

.preset-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
}

.preset-btn {
    padding: var(--space-sm) var(--space-md);
    text-align: left;
    background: var(--bg-elevated);
    border: var(--border-width-md) solid var(--border);
    color: var(--text-primary);
    cursor: pointer;
    font-family: var(--font-mono);
    font-size: var(--text-caption);
    transition: border-color var(--duration-base) ease, background-color var(--duration-base) ease;
}

.preset-btn:hover {
    border-color: var(--primary);
    background: var(--bg-input);
}

.filter-group {
    margin-bottom: var(--space-md);
}

.filter-group:last-child {
    margin-bottom: 0;
}

.filter-group > label:not(.checkbox-label) {
    display: block;
    font-size: var(--text-xxs);
    font-weight: var(--weight-semibold);
    margin-bottom: var(--space-xs);
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
}

.range-inputs {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.range-inputs input {
    width: var(--col-field-width);
    text-align: center;
}

.range-inputs span {
    color: var(--text-muted);
    font-size: var(--text-caption);
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    cursor: pointer;
    font-size: var(--text-caption);
}

.checkbox-label input[type="checkbox"] {
    width: auto;
    margin: 0;
}

.column-checkboxes {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.export-main {
    background-color: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    min-height: var(--export-min-height);
    display: flex;
    flex-direction: column;
}

.preview-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-sm) var(--space-md);
    background-color: var(--bg-elevated);
    border-bottom: var(--border-width-md) solid var(--border);
}

.preview-header h2 {
    font-size: var(--text-sm);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
}

.preview-count {
    font-size: var(--text-caption);
    color: var(--lcd-text);
    font-variant-numeric: tabular-nums;
}

.export-actions {
    display: flex;
    gap: var(--space-sm);
}

.preview-table-wrapper {
    flex: 1;
    overflow: auto;
    padding: var(--space-md);
    background-color: var(--lcd-bg);
}

.preview-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--text-caption);
}

.preview-table th {
    text-align: left;
    padding: var(--space-sm) var(--space-md);
    font-weight: var(--weight-semibold);
    color: var(--lcd-dim);
    font-size: var(--text-2xs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    background-color: var(--bg-input);
    border-bottom: var(--border-width-sm) solid var(--border);
    white-space: nowrap;
}

.preview-table td {
    padding: var(--space-sm) var(--space-md);
    border-bottom: var(--border-width-sm) solid var(--border);
    white-space: nowrap;
    max-width: var(--table-cell-max-width);
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--lcd-text);
}

.preview-table tbody tr:hover {
    background-color: var(--success-bg-faint);
}

.preview-note {
    padding: var(--space-md);
    text-align: center;
    font-size: var(--text-caption);
    color: var(--text-muted);
}

.loading-message {
    padding: var(--space-2xl);
    text-align: center;
    color: var(--text-secondary);
}

/* Export tabs */
.export-tabs {
    display: flex;
    gap: var(--space-xs);
    margin-bottom: var(--space-lg);
    border-bottom: var(--border-width-md) solid var(--bg-surface);
    padding-bottom: var(--space-xs);
}

.tab-btn {
    background: transparent;
    border: none;
    padding: var(--space-sm) var(--space-md);
    font-size: var(--text-base);
    color: var(--text-secondary);
    cursor: pointer;
    border-bottom: var(--border-width-md) solid transparent;
    margin-bottom: calc(var(--border-width-md) * -1);
    transition: color var(--duration-base) ease, border-color var(--duration-base) ease;
}

.tab-btn:hover {
    color: var(--text-primary);
}

.tab-btn.active {
    color: var(--primary);
    border-bottom-color: var(--primary);
}

/* Export cue section */
.export-cue-section {
    border-left: var(--border-width-accent) solid var(--primary);
}

.cue-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.cue-header h3 {
    margin: 0;
}

.cue-count {
    background: var(--primary);
    color: var(--bg-body);
    padding: var(--space-2xs) var(--space-sm);
    /* No border-radius - MPC style */
    font-size: var(--text-caption);
    font-weight: var(--weight-semibold);
}

.cue-hint {
    font-size: var(--text-sm);
    margin: var(--space-xs) 0;
}

.cue-list {
    max-height: var(--list-max-height);
    overflow-y: auto;
    margin: var(--space-sm) 0;
}

.cue-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-xs) 0;
    border-bottom: var(--border-width-sm) solid var(--bg-surface);
    font-size: var(--text-sm);
}

.cue-item:last-child {
    border-bottom: none;
}

.cue-item-info {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    flex: 1;
}

.cue-item-remove {
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    padding: var(--space-2xs) var(--space-xs);
    font-size: var(--text-base);
}

.cue-item-remove:hover {
    color: var(--text-primary);
}

.cue-actions {
    display: flex;
    gap: var(--space-xs);
    margin-top: var(--space-sm);
}

/* Selection controls */
.select-all-label {
    margin-right: var(--space-md);
}

.preview-table .row-checkbox {
    width: var(--icon-lg);
    cursor: pointer;
}

.row-checkbox-col {
    width: var(--track-toggle-width);
    text-align: center;
}

/* Seller mode column highlighting */
.seller-column {
    background: var(--primary-bg-light);
}

/* Toggle switch for export format */
.toggle-switch-wrapper {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    margin-top: var(--space-xs);
}

.toggle-label-left,
.toggle-label-right {
    font-size: var(--text-caption);
    color: var(--primary);
    font-weight: var(--weight-medium);
}

.toggle-hint {
    font-size: var(--text-xs);
    margin-top: var(--space-xs);
}

/* ============================================
   FLASH MESSAGES
   ============================================ */

.flash-messages {
    padding: var(--space-md) var(--space-xl);
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
    max-width: var(--max-width-page);
    margin: 0 auto;
    width: 100%;
}

.flash {
    padding: var(--space-sm) var(--space-md);
    font-size: var(--text-sm);
    border: var(--border-width-md) solid;
}

.flash-success {
    background-color: var(--success-bg-light);
    border-color: var(--success);
    color: var(--success);
}

.flash-error {
    background-color: var(--error-bg-light);
    border-color: var(--error);
    color: var(--error);
}

.flash-info {
    background-color: var(--primary-bg-light);
    border-color: var(--primary);
    color: var(--primary);
}

.flash-warning {
    background-color: var(--warning-bg-light);
    border-color: var(--warning);
    color: var(--warning);
}

/* ============================================
   SETTINGS PAGE
   ============================================ */

.settings-page {
    max-width: var(--max-width-narrow);
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
}

.settings-section {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
}

.settings-section h2 {
    font-size: var(--text-body);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    padding-bottom: var(--space-sm);
    border-bottom: var(--border-width-md) solid var(--border);
}

/* Account Info */
.account-info {
    display: flex;
    align-items: center;
    gap: var(--space-md);
}

.account-avatar {
    width: var(--icon-4xl);
    height: var(--icon-4xl);
    object-fit: cover;
    border: var(--border-width-md) solid var(--border);
}

.account-details {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
}

.account-name {
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
}

.account-email {
    font-size: var(--text-sm);
    color: var(--text-secondary);
}

/* Discogs Connection */
.discogs-connected {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-md);
    background-color: var(--bg-elevated);
    border: var(--border-width-sm) solid var(--border);
    margin-bottom: var(--space-md);
}

.connection-status {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.discogs-form {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
}

.discogs-form.hidden {
    display: none;
}

.form-actions {
    display: flex;
    align-items: center;
    gap: var(--space-md);
}

.save-status {
    font-size: var(--text-caption);
    transition: color var(--duration-base) ease;
}

.save-status.saving { color: var(--warning); }
.save-status.saved { color: var(--success); }
.save-status.error { color: var(--error); }

/* Discogs Connect Button - uses Discogs brand colors */
.btn-discogs {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background-color: var(--discogs-bg);
    color: var(--discogs-text);
    border: var(--border-width-md) solid var(--discogs-border);
    padding: var(--space-sm) var(--space-lg);
    font-family: var(--font-mono);
    font-size: var(--text-body);
    font-weight: var(--weight-medium);
    cursor: pointer;
    text-decoration: none;
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
    transition: background-color var(--duration-base) ease, border-color var(--duration-base) ease;
}

.btn-discogs:hover {
    background-color: var(--discogs-bg-hover);
    border-color: var(--discogs-border-hover);
    color: var(--discogs-text);
}

.btn-discogs svg {
    flex-shrink: 0;
}

.disconnect-form {
    display: inline;
}

.discogs-not-connected {
    text-align: center;
    padding: var(--space-lg) 0;
}

/* Settings Forms - Token form, backup form, etc. */
.token-form {
    max-width: var(--max-width-sidebar);
}

.token-form .form-group {
    margin-bottom: var(--space-md);
}

.token-form label {
    display: block;
    margin-bottom: var(--space-xs);
    font-weight: var(--weight-medium);
}

/* LCD-style form inputs */
.token-form .form-control,
.settings-page .form-control {
    width: 100%;
    padding: var(--space-sm);
    border: var(--border-width-sm) solid var(--border);
    background: var(--bg-input);
    color: var(--text-primary);
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    /* LCD-like inset shadow for recessed screen effect */
    box-shadow: var(--shadow-inset-sm);
}

.token-form .form-control:focus,
.settings-page .form-control:focus {
    outline: none;
    border-color: var(--primary);
}

.token-form small {
    display: block;
    margin-top: var(--space-xs);
}

/* Backup actions */
.backup-actions {
    display: flex;
    gap: var(--space-md);
    align-items: center;
    flex-wrap: wrap;
}

.import-form {
    display: inline-block;
}

/* Seller settings checkboxes */
.seller-settings-form .form-check {
    margin-bottom: var(--space-md);
}

.form-check {
    display: flex;
    align-items: flex-start;
    gap: var(--space-sm);
}

.form-check-input {
    margin-top: var(--space-xs);
    flex-shrink: 0;
}

.form-check-label {
    display: flex;
    flex-direction: column;
    gap: var(--space-2xs);
}

.form-check-label .text-muted {
    font-size: var(--text-sm);
}

/* Key notation radio options */
.key-options {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
    margin-top: var(--space-sm);
}

.radio-label {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    cursor: pointer;
}

.radio-label input[type="radio"] {
    width: auto;
    margin: 0;
}

/* Seller status indicator */
.seller-status {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-md);
    margin-bottom: var(--space-md);
}

.seller-enabled {
    background-color: var(--success-bg-light);
    border: var(--border-width-sm) solid var(--success);
}

.seller-disabled {
    background-color: var(--bg-elevated);
    border: var(--border-width-sm) solid var(--border);
}

.seller-options-enabled {
    padding-left: var(--space-md);
    border-left: var(--border-width-md) solid var(--success);
}

/* Auto-backup section */
.auto-backup-section {
    margin-top: var(--space-lg);
    padding-top: var(--space-md);
    border-top: var(--border-width-sm) solid var(--border);
}

.auto-backup-section h3 {
    font-size: var(--text-sm);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wide);
    margin-bottom: var(--space-sm);
}

.auto-backup-form .form-group {
    margin-top: var(--space-md);
}

.auto-backup-form label[for="backup_path"] {
    display: block;
    margin-bottom: var(--space-xs);
    font-weight: var(--weight-medium);
}

.auto-backup-form small {
    display: block;
    margin-top: var(--space-xs);
}

/* Toggle setting row - label with toggle on right */
.toggle-setting {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-md);
    padding: var(--space-sm) 0;
    cursor: pointer;
    max-width: var(--setting-max-width);
}

.toggle-setting-text {
    display: flex;
    flex-direction: column;
    gap: var(--space-2xs);
}

.toggle-setting-text .text-muted {
    font-size: var(--text-sm);
}

/* Details/summary for collapsible sections */
.settings-section details summary {
    cursor: pointer;
    font-size: var(--text-sm);
    color: var(--text-muted);
}

.settings-section details summary:hover {
    color: var(--text-secondary);
}

.settings-section details[open] summary {
    margin-bottom: var(--space-md);
}

/* ============================================
   RESPONSIVE
   ============================================ */

/* Mobile/small screen adjustments (--bp-sm) */
@media (max-width: 768px) {
    html {
        font-size: 13px;
    }

    .nav {
        flex-wrap: wrap;
        gap: var(--space-sm);
    }

    .nav-links {
        gap: var(--space-sm);
        order: 3;
        width: 100%;
        justify-content: center;
        padding-top: var(--space-sm);
        border-top: var(--border-width-sm) solid var(--border);
    }

    .release-header {
        flex-direction: column;
        align-items: center;
        text-align: center;
    }

    .release-cover-large {
        width: var(--cover-md);
        height: var(--cover-md);
    }

    .release-info-large {
        align-items: center;
    }

    .release-meta-large,
    .release-stats,
    .release-actions {
        justify-content: center;
    }

    .releases-grid {
        grid-template-columns: repeat(auto-fill, minmax(var(--grid-card-sm-min), var(--grid-card-sm-max)));
    }

    .collection-toolbar {
        flex-direction: column;
        align-items: stretch;
    }

    .search-form {
        max-width: none;
    }

    .filter-buttons {
        justify-content: center;
        flex-wrap: wrap;
    }
}

/* ============================================
   SIDE PANEL - Collection View
   ============================================ */

/* Release card as clickable element */
.release-card {
    cursor: pointer;
}

.release-card.selected {
    border-color: var(--primary);
    box-shadow: var(--shadow-focus);
}

/* Side Panel */
.release-panel {
    position: fixed;
    top: 0;
    right: 0;
    width: var(--sidebar-width);
    height: 100vh;
    background-color: var(--bg-surface);
    border-left: var(--border-width-md) solid var(--border);
    transform: translateX(100%);
    transition: transform var(--duration-slow) ease-out;
    z-index: var(--z-overlay);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    /* No decorative shadow - MPC style uses borders for separation */
}

.release-panel.open {
    transform: translateX(0);
}

.panel-header-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-xs) var(--space-sm);
    background-color: var(--bg-elevated);
    border-bottom: var(--border-width-md) solid var(--border);
    flex-shrink: 0;
}

#panel-expand-slot {
    display: flex;
}

.panel-close {
    background: none;
    border: var(--border-width-sm) solid var(--border);
    font-size: var(--text-xl);
    color: var(--text-muted);
    cursor: pointer;
    padding: var(--space-xs) var(--space-sm);
    font-family: var(--font-mono);
    line-height: var(--leading-none);
    transition: color var(--duration-base) ease, border-color var(--duration-base) ease;
}

.panel-close:hover {
    color: var(--primary);
    border-color: var(--primary);
}

.panel-content {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
}

.panel-loading,
.panel-error {
    display: flex;
    justify-content: center;
    align-items: center;
    height: var(--panel-loading-height);
    color: var(--text-muted);
}

.panel-error {
    color: var(--error);
}

/* Panel Release Content - main sidebar container */
.panel-release {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
    height: 100%;
    overflow: hidden;
}

/* Discogs Card - LCD screen style, clickable to open full page */
.panel-discogs-card {
    display: flex;
    background-color: var(--lcd-bg);
    border: var(--border-width-md) solid var(--border);
    cursor: pointer;
    /* Functional shadow for recessed LCD screen effect */
    box-shadow: var(--shadow-inset-lcd);
    transition: border-color var(--duration-base) ease;
}

.panel-discogs-card:hover {
    border-color: var(--primary);
}

/* Main content area (cover + info) */
.panel-discogs-content {
    flex: 1;
    min-width: 0;
    display: flex;
    gap: var(--space-md);
    padding: var(--space-md);
}

/* Vertical button column on right side */
.panel-discogs-buttons {
    display: flex;
    flex-direction: column;
    border-left: var(--border-width-sm) solid var(--border);
    flex-shrink: 0;
}

.panel-discogs-btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--btn-discogs-width);
    padding: var(--space-sm);
    background: transparent;
    border: none;
    border-bottom: var(--border-width-sm) solid var(--border);
    color: var(--text-secondary);
    cursor: pointer;
    text-decoration: none;
    transition: background-color var(--duration-base) ease, color var(--duration-base) ease;
}

.panel-discogs-btn:last-child {
    border-bottom: none;
}

.panel-discogs-btn:hover {
    background-color: var(--primary-bg-muted);
    color: var(--primary);
}

.panel-discogs-btn .emoji-icon {
    font-size: var(--icon-md);
    font-weight: var(--weight-bold);
    /* Centering: flex container handles alignment,
       line-height ensures vertical centering within the icon itself */
    line-height: var(--leading-none);
    display: flex;
    align-items: center;
    justify-content: center;
}

.panel-discogs-btn .activity-led {
    position: absolute;
}

/* Sync icon - custom SVG */
.sync-icon {
    width: var(--icon-base);
    height: var(--icon-base);
    display: block;
    flex-shrink: 0;
}

/* Sync icon in buttons with text needs spacing */
.btn .sync-icon {
    margin-right: var(--space-xs);
}

/* Panel discogs button has larger icon, no margin */
.panel-discogs-btn .sync-icon {
    width: var(--icon-md);
    height: var(--icon-md);
    margin-right: 0;
}

.panel-discogs-btn.is-loading .sync-icon,
.btn.is-loading .sync-icon {
    animation: spin var(--duration-spin) linear infinite;
}

.panel-discogs-btn.has-error {
    color: var(--error);
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.panel-discogs-card .panel-info h2,
.panel-discogs-card .panel-artist,
.panel-discogs-card .panel-meta,
.panel-discogs-card .panel-stats {
    color: var(--lcd-text);
}

.panel-discogs-card .panel-stats .text-success {
    color: var(--success);
}

.panel-discogs-card .panel-meta {
    opacity: var(--opacity-muted);
}

/* Compact stats display */
.panel-stats {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-sm);
    font-size: var(--text-xs);
    color: var(--text-secondary);
    margin-top: var(--space-xs);
}

.panel-stat {
    font-variant-numeric: tabular-nums;
    display: inline-flex;
    align-items: center;
    gap: var(--space-2xs);
}

.panel-stat .stat-icon {
    font-size: var(--text-micro);
    opacity: var(--opacity-muted);
}

.panel-stat .stat-label {
    font-size: var(--text-3xs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
    opacity: var(--opacity-faded);
    margin-left: 1px;
}

/* Notes indicator on title */
.panel-notes-indicator {
    margin-left: var(--space-xs);
    font-size: var(--text-xxs);
    vertical-align: middle;
}

.panel-cover {
    width: var(--cover-sm);
    height: var(--cover-sm);
    flex-shrink: 0;
    overflow: hidden;
    background-color: var(--bg-elevated);
    /* No border - contained within card's border */
}

.panel-cover img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.cover-placeholder-panel {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    font-size: var(--text-xxs);
    text-transform: uppercase;
}

.panel-info {
    flex: 1;
    min-width: 0;
}

.panel-info h2 {
    font-size: var(--text-base);
    font-weight: var(--weight-bold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-normal);
    line-height: var(--leading-tight);
    margin-bottom: var(--space-xs);
}

.panel-artist {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    margin-bottom: var(--space-xs);
}

.panel-meta {
    display: flex;
    gap: var(--space-sm);
    font-size: var(--text-xs);
    color: var(--text-muted);
    margin-bottom: var(--space-xs);
}

/* NOTE: .panel-actions is defined in the form panel section (~line 3344) */

.panel-crates {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
    flex-shrink: 0;
}

.panel-notes {
    background-color: var(--bg-elevated);
    padding: var(--space-sm);
    border: var(--border-width-sm) solid var(--border);
}

.panel-notes h4 {
    font-size: var(--text-xxs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    color: var(--text-muted);
    margin-bottom: var(--space-xs);
}

.panel-notes p {
    font-size: var(--text-sm);
    white-space: pre-wrap;
    margin: 0;
}

/* Panel Tracks - LCD style continuation */
.panel-tracks {
    flex: 1;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background-color: var(--lcd-bg);
    border: var(--border-width-md) solid var(--border);
    /* Functional shadow for recessed LCD screen effect */
    box-shadow: var(--shadow-inset-lcd);
}

.panel-tracks-list {
    flex: 1;
    overflow-y: auto;
    min-height: 0;
}

/* Panel track row - vertical stack of two rows
   IMPORTANT: All .panel-track-row styles consolidated here.
   Playable highlighting modifiers are in SHARED COMPONENTS section. */
.panel-track-row {
    display: flex;
    flex-direction: column;
    gap: var(--space-2xs);
    padding: var(--space-sm) var(--space-md);
    cursor: default;
    /* Borders for playable highlighting - always present, colors change */
    border-left: var(--border-width-sm) solid var(--border);
    border-right: var(--border-width-sm) solid var(--border);
    border-bottom: var(--border-width-sm) solid var(--border);
    transition: opacity var(--duration-base) ease, background-color var(--duration-base) ease, border-color var(--duration-base) ease;
    box-sizing: border-box;
}

.panel-track-row:first-child {
    border-top: var(--border-width-sm) solid var(--border);
}

/* Row 1: Position + Title + Duration */
.panel-track-main {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
}

/* Row 2: Toggle + BPM + Key + Energy + Notes + Tags */
.panel-track-fields {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
}

/* Position indicator - centered over toggle below */
.panel-track-pos {
    font-size: var(--text-xs);
    font-weight: var(--weight-bold);
    color: var(--lcd-dim);
    text-transform: uppercase;
    letter-spacing: var(--tracking-tight);
    flex-shrink: 0;
    width: var(--toggle-mini-width);
    text-align: center;
}

/* Position turns orange when track is playable */
.panel-track-row:not(.track-dimmed) .panel-track-pos {
    color: var(--primary);
}

.panel-track-title {
    flex: 1;
    min-width: 0;
    font-size: var(--text-xs);
    font-weight: var(--weight-medium);
    color: var(--lcd-text);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.panel-track-duration {
    font-size: var(--text-2xs);
    color: var(--lcd-dim);
    flex-shrink: 0;
    font-variant-numeric: tabular-nums;
}

.panel-track-meta {
    display: flex;
    gap: var(--space-xs);
    margin-top: var(--space-xs);
    padding-left: var(--track-indent);
}

/* Panel Inputs - Editable fields with visual distinction */
.panel-input {
    width: var(--input-sm-width);
    padding: var(--space-2xs) var(--space-xs);
    font-family: var(--font-mono);
    font-size: var(--text-2xs);
    text-align: center;
    background: transparent;
    border: var(--border-width-sm) solid transparent;
    color: var(--lcd-text);
    transition: border-color var(--duration-base) ease, background-color var(--duration-base) ease;
}

/* Editable variant - shows it's interactive */
.panel-input--editable {
    /* Always solid border to prevent layout shift - use subtle color for empty state */
    border: var(--border-width-sm) solid var(--lcd-dim-alpha);
    color: var(--lcd-text);
}

/* Hide number input spinner arrows (BPM field) */
.panel-bpm {
    -webkit-appearance: textfield;
    -moz-appearance: textfield;
    appearance: textfield;
}

.panel-bpm::-webkit-outer-spin-button,
.panel-bpm::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

.panel-input--editable::placeholder {
    color: var(--lcd-dim);
    opacity: var(--opacity-muted);
}

.panel-input--editable:hover {
    background: var(--success-bg-light);
    border-color: var(--lcd-text);
}

.panel-input--editable:focus {
    background: var(--success-bg-medium);
    border-color: var(--success);
    outline: none;
}

/* When input has value, show full-opacity border */
.panel-input--editable:not(:placeholder-shown) {
    border-color: var(--lcd-text);
}

.panel-energy-wrap {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
}

.panel-energy-slider {
    width: var(--icon-3xl);
    height: var(--border-width-accent);
    -webkit-appearance: none;
    appearance: none;
    background: var(--border);
    /* No border-radius - MPC style */
    cursor: pointer;
}

.panel-energy-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: var(--led-size);
    height: var(--led-size);
    /* Square thumb - MPC style */
    background: var(--primary);
    cursor: pointer;
}

.panel-energy-slider::-moz-range-thumb {
    width: var(--led-size);
    height: var(--led-size);
    /* Square thumb - MPC style */
    background: var(--primary);
    border: none;
    cursor: pointer;
}

.panel-energy-val {
    font-size: var(--text-xxs);
    color: var(--text-muted);
    min-width: var(--energy-val-min-width);
    text-align: center;
}

/* Panel track tags - now inline in fields row */
.panel-track-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2xs);
    align-items: center;
}

.tag-badge-sm {
    display: inline-block;
    padding: 0 var(--space-xs);
    font-size: var(--text-3xs);
    font-weight: var(--weight-semibold);
    background-color: var(--tag-color, var(--tag-default));
    color: var(--bg-primary);
    text-transform: uppercase;
    letter-spacing: var(--tracking-tight);
}

/* Responsive: hide panel on small screens, use modal instead (--bp-md) */
@media (max-width: 900px) {
    .release-panel {
        width: 100%;
        left: 0;
    }
}

/* Expand button */
.panel-expand-btn {
    width: var(--btn-sm-size);
    height: var(--btn-sm-size);
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: var(--border-width-sm) solid var(--border);
    color: var(--primary);
    transition: border-color var(--duration-base) ease, background-color var(--duration-base) ease;
}

.panel-expand-btn:hover {
    border-color: var(--primary);
    background: var(--primary-dim);
}

.panel-expand-btn svg {
    stroke: var(--primary);
}

/* Actions container - notes + tags pushed to right */
.panel-track-actions {
    display: flex;
    gap: var(--space-xs);
    align-items: center;
    margin-left: auto;
}

/* Panel notes button - icon button for LCD background */
.panel-notes-btn {
    width: var(--icon-md);
    height: var(--icon-md);
    padding: 0;
    background: transparent;
    border: var(--border-width-sm) dashed var(--lcd-dim);
    color: var(--lcd-dim);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    transition: border-color var(--duration-base) ease, color var(--duration-base) ease, background-color var(--duration-base) ease;
}
.panel-notes-btn .emoji-icon {
    font-size: var(--text-sm);
    line-height: var(--leading-none);
}

.panel-notes-btn:hover {
    border-color: var(--lcd-text);
    color: var(--lcd-text);
}

.panel-notes-btn.has-notes {
    border-style: solid;
    border-color: var(--warning);
    color: var(--warning);
    background-color: var(--warning-bg-medium);
}

/* Panel tag add - icon button for LCD background */
.panel-tag-add-btn {
    width: var(--icon-md);
    height: var(--icon-md);
    padding: 0;
    border: var(--border-width-sm) dashed var(--lcd-dim);
    background: transparent;
    color: var(--lcd-dim);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    transition: border-color var(--duration-base) ease, color var(--duration-base) ease;
}

.panel-tag-add-btn .emoji-icon {
    font-size: var(--text-sm);
    line-height: var(--leading-none);
}
.panel-tag-add-btn:hover {
    border-color: var(--lcd-text);
    color: var(--lcd-text);
}

.panel-tag-input {
    width: var(--slider-width);
    padding: var(--space-2xs) var(--space-xs);
    font-size: var(--text-3xs);
    background-color: var(--success-bg-light);
    border: var(--border-width-sm) solid var(--lcd-text);
    color: var(--lcd-text);
}

/* Tag badge small - extend existing with remove button */
.tag-badge-sm .tag-remove-sm {
    background: none;
    border: none;
    color: inherit;
    cursor: pointer;
    padding: 0;
    margin-left: var(--space-2xs);
    font-size: var(--text-xxs);
    line-height: var(--leading-none);
    opacity: 0;
    transition: opacity var(--duration-fast);
}

.tag-badge-sm:hover .tag-remove-sm {
    opacity: var(--opacity-muted);
}

/* Panel header section */
.panel-header {
    flex-shrink: 0;
    position: relative;
    padding: var(--space-md);
}

/* Panel Toolbar - unified actions + crates row */
.panel-toolbar {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-md);
    background-color: var(--bg-elevated);
    border-bottom: var(--border-width-sm) solid var(--border);
}

.panel-toolbar-actions {
    display: flex;
    gap: var(--space-xs);
    align-items: stretch;
    flex-shrink: 0;
}

.panel-toolbar-actions .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.panel-toolbar-crates {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
    align-items: center;
    flex: 1;
    min-width: 0;
}

/* Panel crate dropdown wrapper */
.panel-crate-dropdown-wrapper {
    position: relative;
    display: inline-flex;
    align-items: stretch;
}

.panel-crate-dropdown-wrapper .btn {
    display: flex;
    align-items: center;
}

/* Panel notes textarea */
.panel-notes-textarea {
    flex-shrink: 0;
    width: 100%;
    min-height: var(--textarea-base-height);
    max-height: var(--notes-compact-max-height);
    padding: var(--space-md);
    border: var(--border-width-sm) solid var(--border);
    background: var(--bg-input);
    color: var(--text-primary);
    font-family: inherit;
    font-size: var(--text-sm);
    line-height: var(--leading-normal);
    resize: none;
    box-sizing: border-box;
}

.panel-notes-textarea:focus {
    outline: none;
    border-color: var(--primary);
}

.panel-notes-textarea::placeholder {
    color: var(--text-muted);
}

/* LCD variant - sits below Discogs card, matches LCD aesthetic */
/* Notes LCD - connects visually to Discogs card above */
.panel-notes-lcd {
    background-color: var(--lcd-bg);
    border: var(--border-width-md) solid var(--border);
    border-top: none;  /* Card's bottom border serves as separator */
    /* Pull up to sit adjacent to card (overcome parent gap only) */
    margin-top: calc(var(--space-sm) * -1);
    color: var(--lcd-text);
    min-height: var(--textarea-min-height);
    max-height: var(--textarea-max-height);
    font-family: var(--font-mono);
    font-size: var(--text-caption);
    caret-color: var(--success);
    /* Functional shadow for recessed effect, matching card above */
    box-shadow: var(--shadow-inset-lcd);
}

.panel-notes-lcd:focus {
    border-color: var(--success);
    box-shadow: var(--shadow-inset-lcd), var(--shadow-focus-success);
}

.panel-notes-lcd::placeholder {
    color: var(--lcd-dim);
}

/* Panel crate dropdown */
.panel-crate-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    min-width: var(--dropdown-min-width);
    max-height: var(--dropdown-max-height);
    overflow-y: auto;
    background: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    z-index: var(--z-sticky);
    margin-top: var(--space-2xs);
}

.panel-crate-dropdown-list {
    padding: var(--space-xs) 0;
}

.panel-crate-item {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-xs) var(--space-sm);
    cursor: pointer;
    font-size: var(--text-caption);
    transition: background-color var(--duration-fast);
}

.panel-crate-item:hover {
    background-color: var(--bg-elevated);
}

.panel-crate-item.selected {
    background-color: var(--primary-dim);
}

.panel-crate-item input[type="checkbox"] {
    width: auto;
    margin: 0;
    cursor: pointer;
}

.panel-crate-item-icon {
    font-size: var(--text-body);
}

.panel-crate-item-name {
    flex: 1;
}

.panel-tracks-header {
    flex-shrink: 0;
    padding: var(--space-sm) var(--space-md);
    border-bottom: var(--border-width-sm) solid var(--border);
}

.panel-tracks-header h3 {
    margin: 0;
    font-size: var(--text-xs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    color: var(--success);
    font-weight: var(--weight-semibold);
}

/* Panel notes modal */
.panel-notes-modal {
    position: fixed;
    top: 0;
    right: 0;
    width: var(--sidebar-width);
    height: 100vh;
    background-color: var(--overlay-heavy);
    z-index: var(--z-modal);
    display: flex;
    align-items: center;
    justify-content: center;
}

.panel-notes-modal-content {
    background-color: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    padding: var(--space-md);
    width: 90%;
    max-width: var(--modal-panel-max-width);
}

.panel-notes-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-md);
}

.panel-notes-modal-header h4 {
    font-size: var(--text-sm);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
}

/* Panel track notes textarea - MPC2000 rectangular, no border-radius */
#panel-track-notes-textarea {
    width: 100%;
    padding: var(--space-sm);
    border: var(--border-width-sm) solid var(--border);
    background: var(--bg-input);
    color: var(--text-primary);
    font-family: inherit;
    font-size: var(--text-sm);
    resize: vertical;
}

.panel-notes-modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--space-sm);
    margin-top: var(--space-md);
}

/* =============================================
   SHARED COMPONENTS
   Components used across multiple pages
   Changes here affect ALL instances sitewide
   ============================================= */

/* --------------------------------------------
   ENERGY BAR
   5-segment horizontal bar for track energy

   SPECS:
   - Height: 18px (default), 14px (--sm)
   - Segment width: 14px (default), 10px (--sm)
   - Segment gap: var(--space-2xs) = 2px
   - Border: none (MPC style solid rectangles)

   STRUCTURE:
   .energy-bar[data-value="0-5"]
     .energy-segment[data-level="1-5"] (x5)

   COLORS BY VALUE:
   - 1: green (--success)
   - 2: lime (#84cc16)
   - 3: yellow (--warning)
   - 4: orange (--primary)
   - 5: red (--error)
   -------------------------------------------- */
.energy-bar {
    display: flex;
    gap: var(--space-2xs);
    height: var(--energy-bar-height);
    cursor: pointer;
    justify-content: center;
}

.energy-bar--sm {
    height: var(--energy-bar-sm-height);
}

.energy-bar .energy-segment {
    width: var(--energy-segment-width);
    background-color: var(--border);
    /* No border-radius - MPC style rectangular segments */
    transition: background-color var(--duration-base), transform var(--duration-fast);
}

.energy-bar--sm .energy-segment {
    width: var(--energy-segment-sm-width);
}

.energy-bar .energy-segment:hover {
    transform: scaleY(var(--scale-hover-y));
}

/* Energy color states - green  lime  yellow  orange  red */
.energy-bar[data-value="1"] .energy-segment[data-level="1"] { background-color: var(--success); }
.energy-bar[data-value="2"] .energy-segment[data-level="1"],
.energy-bar[data-value="2"] .energy-segment[data-level="2"] { background-color: var(--lime); }
.energy-bar[data-value="3"] .energy-segment[data-level="1"],
.energy-bar[data-value="3"] .energy-segment[data-level="2"],
.energy-bar[data-value="3"] .energy-segment[data-level="3"] { background-color: var(--warning); }
.energy-bar[data-value="4"] .energy-segment[data-level="1"],
.energy-bar[data-value="4"] .energy-segment[data-level="2"],
.energy-bar[data-value="4"] .energy-segment[data-level="3"],
.energy-bar[data-value="4"] .energy-segment[data-level="4"] { background-color: var(--primary); }
.energy-bar[data-value="5"] .energy-segment { background-color: var(--error); }

/* --------------------------------------------
   Action Group - Button grouping with dividers
   Used for Discogs vs Asetate action separation
   -------------------------------------------- */
.action-group {
    display: flex;
    gap: var(--space-xs);
    align-items: stretch;
}

.action-group .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.action-group--discogs,
.action-group.discogs-actions {
    padding-right: var(--space-md);
    border-right: var(--border-width-sm) solid var(--border);
}

.action-group--discogs-sm,
.action-group.discogs-group {
    padding-right: var(--space-sm);
    border-right: var(--border-width-sm) solid var(--border);
}

/* --------------------------------------------
   Crate Dropdown - Multi-select crate picker
   -------------------------------------------- */
.crate-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    min-width: var(--dropdown-min-width);
    max-height: var(--dropdown-max-height);
    overflow-y: auto;
    background: var(--bg-surface);
    border: var(--border-width-md) solid var(--border);
    z-index: var(--z-sticky);
    margin-top: var(--space-2xs);
}

.crate-dropdown--lg {
    min-width: var(--dropdown-lg-min-width);
    max-height: var(--dropdown-lg-max-height);
}

.crate-dropdown-list {
    padding: var(--space-xs) 0;
}

.crate-dropdown-item {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-xs) var(--space-sm);
    cursor: pointer;
    font-size: var(--text-caption);
    transition: background-color var(--duration-fast);
}

.crate-dropdown-item:hover {
    background-color: var(--bg-elevated);
}

.crate-dropdown-item.selected {
    background-color: var(--primary-dim);
}

.crate-dropdown-item input[type="checkbox"] {
    width: auto;
    margin: 0;
    cursor: pointer;
}

.crate-dropdown-item-icon {
    font-size: var(--text-body);
}

.crate-dropdown-item-name {
    flex: 1;
}

/* Crate dropdown wrapper - ensures button height matching */
.crate-dropdown-wrapper {
    position: relative;
    display: inline-flex;
    align-items: stretch;
}

.crate-dropdown-wrapper .btn {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* --------------------------------------------
   Notes Textarea - Auto-save release/track notes
   -------------------------------------------- */
.notes-textarea {
    width: 100%;
    min-height: var(--textarea-base-height);
    padding: var(--space-md);
    border: var(--border-width-sm) solid var(--border);
    background: var(--bg-input);
    color: var(--text-primary);
    font-family: inherit;
    font-size: var(--text-sm);
    line-height: var(--leading-normal);
    resize: none;
    box-sizing: border-box;
}

.notes-textarea:focus {
    outline: none;
    border-color: var(--primary);
}

.notes-textarea::placeholder {
    color: var(--text-muted);
}

/* Large variant for full-page view */
.notes-textarea--lg {
    width: var(--max-width-sidebar);
    height: var(--notes-lg-height);
}

/* Compact variant for panel */
.notes-textarea--panel {
    max-height: var(--notes-compact-max-height);
}

/* --------------------------------------------
   Track Notes Button - Inline notes indicator
   -------------------------------------------- */
.track-notes-btn {
    display: inline-block;
    padding: var(--space-2xs) var(--space-xs);
    font-size: var(--text-2xs);
    font-family: var(--font-mono);
    cursor: pointer;
    transition: opacity var(--duration-base) ease, border-color var(--duration-base) ease, color var(--duration-base) ease, background-color var(--duration-base) ease;
}

.track-notes-btn--empty {
    color: var(--text-muted);
    border: var(--border-width-sm) dashed var(--border);
    opacity: 0;
}

.track-row:hover .track-notes-btn--empty,
.panel-track-row:hover .track-notes-btn--empty {
    opacity: 1;
}

.track-notes-btn--empty:hover {
    border-color: var(--text-muted);
    color: var(--text-secondary);
}

.track-notes-btn--has-notes {
    color: var(--warning);
    background-color: var(--warning-bg-medium);
    border: var(--border-width-sm) solid transparent;
}

.track-notes-btn--has-notes:hover {
    background-color: var(--warning-bg-strong);
}

/* Panel variant - smaller */
.track-notes-btn--sm {
    font-size: var(--text-micro);
    border-style: dashed;
    background: transparent;
    border-color: var(--border);
    color: var(--text-muted);
}

.track-notes-btn--sm:hover {
    border-color: var(--primary);
    color: var(--primary);
}

.track-notes-btn--sm.has-notes {
    border-style: solid;
    border-color: var(--warning);
    color: var(--warning);
    background-color: var(--warning-bg-light);
}

/* --------------------------------------------
   Panel Track Row - Playable Highlighting
   Mirrors .track-row pattern but uses .track-dimmed
   (class on non-playable) instead of .track-playable

   NOTE: Base .panel-track-row definition is in SIDE PANEL section.
   This section only contains the playable highlighting modifiers.
   -------------------------------------------- */

/* Non-playable tracks are dimmed */
.panel-track-row.track-dimmed {
    opacity: var(--opacity-dim);
}

.panel-track-row.track-dimmed:hover {
    opacity: var(--opacity-muted);
}

/* Playable tracks (not dimmed) get orange left/right borders */
.panel-track-row:not(.track-dimmed) {
    border-left-color: var(--primary-border-alpha);
    border-right-color: var(--primary-border-alpha);
    background-color: var(--primary-bg-faint);
}

/* First playable track gets orange top border */
.panel-track-row:not(.track-dimmed):first-child {
    border-top-color: var(--primary-border-alpha);
}

/* Non-playable followed by playable: orange bottom = top edge of playable section */
.panel-track-row.track-dimmed:has(+ .panel-track-row:not(.track-dimmed)) {
    border-bottom-color: var(--primary-border-alpha);
}

/* Last playable in group gets orange bottom border */
.panel-track-row:not(.track-dimmed):not(:has(+ .panel-track-row:not(.track-dimmed))) {
    border-bottom-color: var(--primary-border-alpha);
}

/* Adjacent playable tracks: inset gray separator that doesn't overlap orange side borders */
.panel-track-row:not(.track-dimmed):has(+ .panel-track-row:not(.track-dimmed)) {
    position: relative;
    border-bottom-color: transparent;
}

.panel-track-row:not(.track-dimmed):has(+ .panel-track-row:not(.track-dimmed))::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: var(--border-width-sm);
    background: var(--border);
}

.panel-track-row:not(.track-dimmed):hover {
    background-color: var(--primary-bg-muted);
}

/* =============================================
   UTILITIES
   Single-purpose helper classes
   Use these instead of inline styles
   ============================================= */

/* -----------------------------------------
   Margin utilities
   Format: .m{side}-{size}
   Sides: t=top, b=bottom, l=left, r=right, x=horizontal, y=vertical
   Sizes: 2xs, xs, sm, md, lg, xl
   ----------------------------------------- */

/* Margin top */
.mt-2xs { margin-top: var(--space-2xs); }
.mt-xs { margin-top: var(--space-xs); }
.mt-sm { margin-top: var(--space-sm); }
.mt-md { margin-top: var(--space-md); }
.mt-lg { margin-top: var(--space-lg); }
.mt-xl { margin-top: var(--space-xl); }

/* Margin bottom */
.mb-2xs { margin-bottom: var(--space-2xs); }
.mb-xs { margin-bottom: var(--space-xs); }
.mb-sm { margin-bottom: var(--space-sm); }
.mb-md { margin-bottom: var(--space-md); }
.mb-lg { margin-bottom: var(--space-lg); }
.mb-xl { margin-bottom: var(--space-xl); }

/* Margin left */
.ml-2xs { margin-left: var(--space-2xs); }
.ml-xs { margin-left: var(--space-xs); }
.ml-sm { margin-left: var(--space-sm); }
.ml-md { margin-left: var(--space-md); }
.ml-lg { margin-left: var(--space-lg); }

/* Margin right */
.mr-2xs { margin-right: var(--space-2xs); }
.mr-xs { margin-right: var(--space-xs); }
.mr-sm { margin-right: var(--space-sm); }
.mr-md { margin-right: var(--space-md); }
.mr-lg { margin-right: var(--space-lg); }

/* Margin horizontal (left + right) */
.mx-xs { margin-left: var(--space-xs); margin-right: var(--space-xs); }
.mx-sm { margin-left: var(--space-sm); margin-right: var(--space-sm); }
.mx-md { margin-left: var(--space-md); margin-right: var(--space-md); }
.mx-auto { margin-left: auto; margin-right: auto; }

/* Margin vertical (top + bottom) */
.my-xs { margin-top: var(--space-xs); margin-bottom: var(--space-xs); }
.my-sm { margin-top: var(--space-sm); margin-bottom: var(--space-sm); }
.my-md { margin-top: var(--space-md); margin-bottom: var(--space-md); }

/* -----------------------------------------
   Padding utilities
   Format: .p{side}-{size}
   ----------------------------------------- */

/* Padding top */
.pt-2xs { padding-top: var(--space-2xs); }
.pt-xs { padding-top: var(--space-xs); }
.pt-sm { padding-top: var(--space-sm); }
.pt-md { padding-top: var(--space-md); }
.pt-lg { padding-top: var(--space-lg); }

/* Padding bottom */
.pb-2xs { padding-bottom: var(--space-2xs); }
.pb-xs { padding-bottom: var(--space-xs); }
.pb-sm { padding-bottom: var(--space-sm); }
.pb-md { padding-bottom: var(--space-md); }
.pb-lg { padding-bottom: var(--space-lg); }

/* Padding left */
.pl-xs { padding-left: var(--space-xs); }
.pl-sm { padding-left: var(--space-sm); }
.pl-md { padding-left: var(--space-md); }
.pl-lg { padding-left: var(--space-lg); }

/* Padding right */
.pr-xs { padding-right: var(--space-xs); }
.pr-sm { padding-right: var(--space-sm); }
.pr-md { padding-right: var(--space-md); }

/* Padding horizontal */
.px-xs { padding-left: var(--space-xs); padding-right: var(--space-xs); }
.px-sm { padding-left: var(--space-sm); padding-right: var(--space-sm); }
.px-md { padding-left: var(--space-md); padding-right: var(--space-md); }
.px-lg { padding-left: var(--space-lg); padding-right: var(--space-lg); }

/* Padding vertical */
.py-xs { padding-top: var(--space-xs); padding-bottom: var(--space-xs); }
.py-sm { padding-top: var(--space-sm); padding-bottom: var(--space-sm); }
.py-md { padding-top: var(--space-md); padding-bottom: var(--space-md); }

/* Padding all sides */
.p-xs { padding: var(--space-xs); }
.p-sm { padding: var(--space-sm); }
.p-md { padding: var(--space-md); }
.p-lg { padding: var(--space-lg); }

/* -----------------------------------------
   Gap utilities (for flex/grid)
   ----------------------------------------- */
.gap-2xs { gap: var(--space-2xs); }
.gap-xs { gap: var(--space-xs); }
.gap-sm { gap: var(--space-sm); }
.gap-md { gap: var(--space-md); }
.gap-lg { gap: var(--space-lg); }

/* -----------------------------------------
   Flexbox utilities
   ----------------------------------------- */
.flex { display: flex; }
.flex-col { display: flex; flex-direction: column; }
.flex-row { display: flex; flex-direction: row; }
.flex-wrap { flex-wrap: wrap; }
.flex-nowrap { flex-wrap: nowrap; }
.flex-1 { flex: 1; }
.flex-shrink-0 { flex-shrink: 0; }

/* Alignment */
.items-start { align-items: flex-start; }
.items-center { align-items: center; }
.items-end { align-items: flex-end; }
.items-stretch { align-items: stretch; }

.justify-start { justify-content: flex-start; }
.justify-center { justify-content: center; }
.justify-end { justify-content: flex-end; }
.justify-between { justify-content: space-between; }

/* Common flex patterns */
.flex-center { display: flex; align-items: center; justify-content: center; }
.flex-between { display: flex; align-items: center; justify-content: space-between; }
.flex-col-center { display: flex; flex-direction: column; align-items: center; }

/* -----------------------------------------
   Grid utilities
   ----------------------------------------- */
.grid { display: grid; }

/* -----------------------------------------
   Width/Height utilities
   ----------------------------------------- */
.w-full { width: 100%; }
.w-auto { width: auto; }
.h-full { height: 100%; }
.min-w-0 { min-width: 0; }  /* Useful for flex children with text overflow */

/* -----------------------------------------
   Text utilities
   ----------------------------------------- */
.text-2xs { font-size: var(--text-2xs); }
.text-xs { font-size: var(--text-xs); }
.text-sm { font-size: var(--text-sm); }
.text-base { font-size: var(--text-base); }
.text-lg { font-size: var(--text-lg); }
.text-xl { font-size: var(--text-xl); }

.text-left { text-align: left; }
.text-center { text-align: center; }
.text-right { text-align: right; }

.font-normal { font-weight: var(--weight-normal); }
.font-medium { font-weight: var(--weight-medium); }
.font-semibold { font-weight: var(--weight-semibold); }
.font-bold { font-weight: var(--weight-bold); }

.uppercase { text-transform: uppercase; }
.lowercase { text-transform: lowercase; }
.capitalize { text-transform: capitalize; }

.tracking-tight { letter-spacing: var(--tracking-tight); }
.tracking-normal { letter-spacing: var(--tracking-normal); }
.tracking-wide { letter-spacing: var(--tracking-wide); }
.tracking-wider { letter-spacing: var(--tracking-wider); }

.truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.whitespace-nowrap { white-space: nowrap; }

/* Text colors */
.text-primary { color: var(--text-primary); }
.text-secondary { color: var(--text-secondary); }
.text-muted { color: var(--text-muted); }
.text-accent { color: var(--primary); }
.text-success { color: var(--success); }
.text-warning { color: var(--warning); }
.text-error { color: var(--error); }
.text-lcd { color: var(--lcd-text); }

/* -----------------------------------------
   Display utilities
   NOTE: .hidden is defined earlier (line ~983) with !important
   ----------------------------------------- */
.block { display: block; }
.inline { display: inline; }
.inline-block { display: inline-block; }
.inline-flex { display: inline-flex; }

/* -----------------------------------------
   Position utilities
   ----------------------------------------- */
.relative { position: relative; }
.absolute { position: absolute; }
.fixed { position: fixed; }
.sticky { position: sticky; }

/* -----------------------------------------
   Border utilities
   ----------------------------------------- */
.border { border: var(--border-width-sm) solid var(--border); }
.border-2 { border: var(--border-width-md) solid var(--border); }
.border-t { border-top: var(--border-width-sm) solid var(--border); }
.border-b { border-bottom: var(--border-width-sm) solid var(--border); }
.border-l { border-left: var(--border-width-sm) solid var(--border); }
.border-r { border-right: var(--border-width-sm) solid var(--border); }
.border-none { border: none; }

.border-primary { border-color: var(--primary); }
.border-success { border-color: var(--success); }
.border-error { border-color: var(--error); }

/* -----------------------------------------
   Background utilities
   ----------------------------------------- */
.bg-body { background-color: var(--bg-body); }
.bg-surface { background-color: var(--bg-surface); }
.bg-elevated { background-color: var(--bg-elevated); }
.bg-lcd { background-color: var(--lcd-bg); }
.bg-transparent { background-color: transparent; }

/* -----------------------------------------
   Cursor utilities
   ----------------------------------------- */
.cursor-pointer { cursor: pointer; }
.cursor-default { cursor: default; }
.cursor-not-allowed { cursor: not-allowed; }

/* -----------------------------------------
   Overflow utilities
   ----------------------------------------- */
.overflow-hidden { overflow: hidden; }
.overflow-auto { overflow: auto; }
.overflow-y-auto { overflow-y: auto; }
.overflow-x-auto { overflow-x: auto; }

/* -----------------------------------------
   Opacity utilities
   ----------------------------------------- */
.opacity-0 { opacity: 0; }
.opacity-50 { opacity: var(--opacity-dim); }
.opacity-75 { opacity: var(--opacity-moderate); }
.opacity-100 { opacity: 1; }

/* -----------------------------------------
   Visibility utilities
   ----------------------------------------- */
.invisible { visibility: hidden; }
.visible { visibility: visible; }

/* -----------------------------------------
   Interaction utilities
   ----------------------------------------- */
.pointer-events-none { pointer-events: none; }
.pointer-events-auto { pointer-events: auto; }
.select-none { user-select: none; }
.select-text { user-select: text; }

/* -----------------------------------------
   Transition utilities
   ----------------------------------------- */
/* DEPRECATED: .transition uses 'all' which can cause performance issues
   Prefer specific transition utilities below */
.transition { transition: opacity var(--duration-base) ease, transform var(--duration-base) ease; }
.transition-colors { transition: background-color var(--duration-base) ease, border-color var(--duration-base) ease, color var(--duration-base) ease; }
.transition-opacity { transition: opacity var(--duration-base) ease; }
.transition-transform { transition: transform var(--duration-base) ease; }

/* -----------------------------------------
   Z-index utilities
   Semantic names mapping to design tokens
   ----------------------------------------- */
.z-base { z-index: var(--z-base); }
.z-raised { z-index: var(--z-raised); }
.z-above { z-index: var(--z-above); }
.z-dropdown { z-index: var(--z-dropdown); }
.z-sticky { z-index: var(--z-sticky); }
.z-overlay { z-index: var(--z-overlay); }
.z-modal { z-index: var(--z-modal); }

/* Legacy numeric utilities (for backwards compatibility) */
.z-0 { z-index: var(--z-base); }
.z-10 { z-index: var(--z-dropdown); }
.z-20 { z-index: var(--z-popover); }
.z-50 { z-index: var(--z-fixed); }
.z-100 { z-index: var(--z-sticky); }

/* =============================================
   EXCEPTIONS
   State-based variations
   ============================================= */

/* Loading states */
.is-loading {
    opacity: var(--opacity-muted);
    pointer-events: none;
}

/* Disabled states */
.is-disabled {
    opacity: var(--opacity-dim);
    pointer-events: none;
    cursor: not-allowed;
}

/* Error states */
.has-error {
    border-color: var(--error);
}

/* Success states */
.has-success {
    border-color: var(--success);
}

/* =============================================
   SCROLLBAR STYLING
   ============================================= */

::-webkit-scrollbar {
    width: var(--led-size);
    height: var(--led-size);
}

::-webkit-scrollbar-track {
    background: var(--bg-primary);
}

::-webkit-scrollbar-thumb {
    background: var(--border-light);
}

::-webkit-scrollbar-thumb:hover {
    background: var(--text-muted);
}
